/**********************
**Author:Abdelrahman**
**********************/

#include <stdio.h>
#include <stdlib.h>

typedef unsigned long long uint64_t;

const unsigned char WORDFILTER = 0xF;


void transpose(uint64_t *out15,uint64_t *out14,uint64_t *out13,uint64_t *out12,uint64_t *out11,uint64_t *out10,uint64_t *out9,uint64_t *out8,uint64_t *out7,uint64_t *out6,uint64_t *out5,uint64_t *out4,uint64_t *out3,uint64_t *out2,uint64_t *out1,uint64_t *out0, uint64_t in0, uint64_t in1,uint64_t in2, uint64_t in3, uint64_t in4, uint64_t in5, uint64_t in6, uint64_t in7, uint64_t in8, uint64_t in9, uint64_t in10, uint64_t in11, uint64_t in12, uint64_t in13, uint64_t in14, uint64_t in15) {

    *out15 = 0;
    *out14 = 0;
    *out13 = 0;
    *out12 = 0;
    *out11 = 0;
    *out10 = 0;
    *out9 = 0;
    *out8 = 0;
    *out7 = 0;
    *out6 = 0;
    *out5 = 0;
    *out4 = 0;
    *out3 = 0;
    *out2 = 0;
    *out1 = 0;
    *out0 = 0;

*out15=(in0 & 0xF000000000000000)|((in1 & 0xF000000000000000)>>4*1)|((in2 & 0xF000000000000000)>>4*2) | ((in3 & 0xF000000000000000)>>4*3)|((in4 & 0xF000000000000000)>>4*4)| ((in5 & 0xF000000000000000)>>4*5) | ((in6 & 0xF000000000000000)>>4*6)|((in7 & 0xF000000000000000)>>4*7)|((in8 & 0xF000000000000000)>>4*8)|((in9 & 0xF000000000000000)>>4*9)|((in10 & 0xF000000000000000)>>4*10)| ((in11 & 0xF000000000000000)>>4*11)|((in12 & 0xF000000000000000)>>4*12)|((in13 & 0xF000000000000000)>>4*13)|((in14 & 0xF000000000000000)>>4*14)|((in15 & 0xF000000000000000)>>4*15);
*out14=((in0 & 0x0F00000000000000)<<4)|((in1 & 0x0F00000000000000))|((in2 & 0x0F00000000000000)>>4*1) | ((in3 & 0x0F00000000000000)>>4*2)|((in4 & 0x0F00000000000000)>>4*3)| ((in5 & 0x0F00000000000000)>>4*4) | ((in6 & 0x0F00000000000000)>>4*5)|((in7 & 0x0F00000000000000)>>4*6)|((in8 & 0x0F00000000000000)>>4*7)|((in9 & 0x0F00000000000000)>>4*8)|((in10 & 0x0F00000000000000)>>4*9)| ((in11 & 0x0F00000000000000)>>4*10)|((in12 & 0x0F00000000000000)>>4*11)|((in13 & 0x0F00000000000000)>>4*12)|((in14 & 0x0F00000000000000)>>4*13)|((in15 & 0x0F00000000000000)>>4*14);
*out13=((in0 & 0x00F0000000000000)<<4*2)|((in1 & 0x00F0000000000000)<<4*1)|((in2 & 0x00F0000000000000)) | ((in3 & 0x00F0000000000000)>>4*1)|((in4 & 0x00F0000000000000)>>4*2)| ((in5 & 0x00F0000000000000)>>4*3) | ((in6 & 0x00F0000000000000)>>4*4)|((in7 & 0x00F0000000000000)>>4*5)|((in8 & 0x00F0000000000000)>>4*6)|((in9 & 0x00F0000000000000)>>4*7)|((in10 & 0x00F0000000000000)>>4*8)| ((in11 & 0x00F0000000000000)>>4*9)|((in12 & 0x00F0000000000000)>>4*10)|((in13 & 0x00F0000000000000)>>4*11)|((in14 & 0x00F0000000000000)>>4*12)|((in15 & 0x00F0000000000000)>>4*13);
*out12=((in0 & 0x000F000000000000)<<4*3)|((in1 & 0x000F000000000000)<<4*2)|((in2 & 0x000F000000000000)<<4*1) | ((in3 & 0x000F000000000000))|((in4 & 0x000F000000000000)>>4*1)| ((in5 & 0x000F000000000000)>>4*2) | ((in6 & 0x000F000000000000)>>4*3)|((in7 & 0x000F000000000000)>>4*4)|((in8 & 0x000F000000000000)>>4*5)|((in9 & 0x000F000000000000)>>4*6)|((in10 & 0x000F000000000000)>>4*7)| ((in11 & 0x000F000000000000)>>4*8)|((in12 & 0x000F000000000000)>>4*9)|((in13 & 0x000F000000000000)>>4*10)|((in14 & 0x000F000000000000)>>4*11)|((in15 & 0x000F000000000000)>>4*12);
*out11=((in0 & 0x0000F00000000000)<<4*4)|((in1 & 0x0000F00000000000)<<4*3)|((in2 & 0x0000F00000000000)<<4*2) | ((in3 & 0x0000F00000000000)<<4*1)|((in4 & 0x0000F00000000000))| ((in5 & 0x0000F00000000000)>>4*1) | ((in6 & 0x0000F00000000000)>>4*2)|((in7 & 0x0000F00000000000)>>4*3)|((in8 & 0x0000F00000000000)>>4*4)|((in9 & 0x0000F00000000000)>>4*5)|((in10 & 0x0000F00000000000)>>4*6)| ((in11 & 0x0000F00000000000)>>4*7)|((in12 & 0x0000F00000000000)>>4*8)|((in13 & 0x0000F00000000000)>>4*9)|((in14 & 0x0000F00000000000)>>4*10)|((in15 & 0x0000F00000000000)>>4*11);
*out10=((in0 & 0x00000F0000000000)<<4*5)|((in1 & 0x00000F0000000000)<<4*4)|((in2 & 0x00000F0000000000)<<4*3) | ((in3 & 0x00000F0000000000)<<4*2)|((in4 & 0x00000F0000000000)<<4*1)| ((in5 & 0x00000F0000000000)) | ((in6 & 0x00000F0000000000)>>4*1)|((in7 & 0x00000F0000000000)>>4*2)|((in8 & 0x00000F0000000000)>>4*3)|((in9 & 0x00000F0000000000)>>4*4)|((in10 & 0x00000F0000000000)>>4*5)| ((in11 & 0x00000F0000000000)>>4*6)|((in12 & 0x00000F0000000000)>>4*7)|((in13 & 0x00000F0000000000)>>4*8)|((in14 & 0x00000F0000000000)>>4*9)|((in15 & 0x00000F0000000000)>>4*10);
*out9=((in0 & 0x000000F000000000)<<4*6)|((in1 & 0x000000F000000000)<<4*5)|((in2 & 0x000000F000000000)<<4*4) | ((in3 & 0x000000F000000000)<<4*3)|((in4 & 0x000000F000000000)<<4*2)| ((in5 & 0x000000F000000000)<<4*1) | ((in6 & 0x000000F000000000))|((in7 & 0x00000F000000000)>>4*1)|((in8 & 0x000000F000000000)>>4*2)|((in9 & 0x000000F000000000)>>4*3)|((in10 & 0x000000F000000000)>>4*4)| ((in11 & 0x000000F000000000)>>4*5)|((in12 & 0x000000F000000000)>>4*6)|((in13 & 0x000000F000000000)>>4*7)|((in14 & 0x000000F000000000)>>4*8)|((in15 & 0x000000F000000000)>>4*9);
*out8=((in0 & 0x0000000F00000000)<<4*7)|((in1 & 0x0000000F00000000)<<4*6)|((in2 & 0x0000000F00000000)<<4*5) | ((in3 & 0x0000000F00000000)<<4*4)|((in4 & 0x0000000F00000000)<<4*3)| ((in5 & 0x0000000F00000000)<<4*2) | ((in6 & 0x0000000F00000000)<<4*1)|((in7 & 0x0000000F00000000))|((in8 & 0x0000000F00000000)>>4*1)|((in9 & 0x0000000F00000000)>>4*2)|((in10 & 0x0000000F00000000)>>4*3)| ((in11 & 0x0000000F00000000)>>4*4)|((in12 & 0x0000000F00000000)>>4*5)|((in13 & 0x0000000F00000000)>>4*6)|((in14 & 0x0000000F00000000)>>4*7)|((in15 & 0x0000000F00000000)>>4*8);
*out7=((in0 & 0x00000000F0000000)<<4*8)|((in1 & 0x00000000F0000000)<<4*7)|((in2 & 0x00000000F0000000)<<4*6) | ((in3 & 0x00000000F0000000)<<4*5)|((in4 & 0x00000000F0000000)<<4*4)| ((in5 & 0x00000000F0000000)<<4*3) | ((in6 & 0x00000000F0000000)<<4*2)|((in7 & 0x00000000F0000000)<<4*1)|((in8 & 0x00000000F0000000))|((in9 & 0x00000000F0000000)>>4*1)|((in10 & 0x00000000F0000000)>>4*2)| ((in11 & 0x00000000F0000000)>>4*3)|((in12 & 0x00000000F0000000)>>4*4)|((in13 & 0x00000000F0000000)>>4*5)|((in14 & 0x00000000F0000000)>>4*6)|((in15 & 0x00000000F0000000)>>4*7);
*out6=((in0 & 0x000000000F000000)<<4*9)|((in1 & 0x000000000F000000)<<4*8)|((in2 & 0x000000000F000000)<<4*7) | ((in3 & 0x000000000F000000)<<4*6)|((in4 & 0x000000000F000000)<<4*5)| ((in5 & 0x000000000F000000)<<4*4) | ((in6 & 0x000000000F000000)<<4*3)|((in7 & 0x000000000F000000)<<4*2)|((in8 & 0x000000000F000000)<<4*1)|((in9 & 0x000000000F000000))|((in10 & 0x000000000F000000)>>4*1)| ((in11 & 0x000000000F000000)>>4*2)|((in12 & 0x000000000F000000)>>4*3)|((in13 & 0x000000000F000000)>>4*4)|((in14 & 0x000000000F000000)>>4*5)|((in15 & 0x000000000F000000)>>4*6);
*out5=((in0 & 0x0000000000F00000)<<4*10)|((in1 & 0x0000000000F00000)<<4*9)|((in2 & 0x0000000000F00000)<<4*8) | ((in3 & 0x0000000000F00000)<<4*7)|((in4 & 0x0000000000F00000)<<4*6)| ((in5 & 0x0000000000F00000)<<4*5) | ((in6 & 0x0000000000F00000)<<4*4)|((in7 & 0x0000000000F00000)<<4*3)|((in8 & 0x0000000000F00000)<<4*2)|((in9 & 0x0000000000F00000)<<4*1)|((in10 & 0x0000000000F00000))| ((in11 & 0x0000000000F00000)>>4*1)|((in12 & 0x0000000000F00000)>>4*2)|((in13 & 0x0000000000F00000)>>4*3)|((in14 & 0x0000000000F00000)>>4*4)|((in15 & 0x0000000000F00000)>>4*5);
*out4=((in0 & 0x00000000000F0000)<<4*11)|((in1 & 0x00000000000F0000)<<4*10)|((in2 & 0x00000000000F0000)<<4*9) | ((in3 & 0x00000000000F0000)<<4*8)|((in4 & 0x00000000000F0000)<<4*7)| ((in5 & 0x00000000000F0000)<<4*6) | ((in6 & 0x00000000000F0000)<<4*5)|((in7 & 0x00000000000F0000)<<4*4)|((in8 & 0x00000000000F0000)<<4*3)|((in9 & 0x00000000000F0000)<<4*2)|((in10 & 0x00000000000F0000)<<4*1)| ((in11 & 0x00000000000F0000))|((in12 & 0x00000000000F0000)>>4*1)|((in13 & 0x00000000000F0000)>>4*2)|((in14 & 0x00000000000F0000)>>4*3)|((in15 & 0x00000000000F0000)>>4*4);
*out3=((in0 & 0x000000000000F000)<<4*12)|((in1 & 0x000000000000F000)<<4*11)|((in2 & 0x000000000000F000)<<4*10) | ((in3 & 0x000000000000F000)<<4*9)|((in4 & 0x000000000000F000)<<4*8)| ((in5 & 0x000000000000F000)<<4*7) | ((in6 & 0x000000000000F000)<<4*6)|((in7 & 0x000000000000F000)<<4*5)|((in8 & 0x000000000000F000)<<4*4)|((in9 & 0x000000000000F000)<<4*3)|((in10 & 0x000000000000F000)<<4*2)| ((in11 & 0x000000000000F000)<<4*1)|((in12 & 0x000000000000F000))|((in13 & 0x000000000000F000)>>4*1)|((in14 & 0x000000000000F000)>>4*2)|((in15 & 0x000000000000F000)>>4*3);
*out2=((in0 & 0x0000000000000F00)<<4*13)|((in1 & 0x0000000000000F00)<<4*12)|((in2 & 0x0000000000000F00)<<4*11) | ((in3 & 0x0000000000000F00)<<4*10)|((in4 & 0x0000000000000F00)<<4*9)| ((in5 & 0x0000000000000F00)<<4*8) | ((in6 & 0x0000000000000F00)<<4*7)|((in7 & 0x0000000000000F00)<<4*6)|((in8 & 0x0000000000000F00)<<4*5)|((in9 & 0x0000000000000F00)<<4*4)|((in10 & 0x0000000000000F00)<<4*3)| ((in11 & 0x0000000000000F00)<<4*2)|((in12 & 0x0000000000000F00)<<4*1)|((in13 & 0x0000000000000F00))|((in14 & 0x0000000000000F00)>>4*1)|((in15 & 0x0000000000000F00)>>4*2);
*out1=((in0 & 0x00000000000000F0)<<4*14)|((in1 & 0x00000000000000F0)<<4*13)|((in2 & 0x00000000000000F0)<<4*12) | ((in3 & 0x00000000000000F0)<<4*11)|((in4 & 0x00000000000000F0)<<4*10)| ((in5 & 0x00000000000000F0)<<4*9) | ((in6 & 0x00000000000000F0)<<4*8)|((in7 & 0x00000000000000F0)<<4*7)|((in8 & 0x00000000000000F0)<<4*6)|((in9 & 0x00000000000000F0)<<4*5)|((in10 & 0x00000000000000F0)<<4*4)| ((in11 & 0x00000000000000F0)<<4*3)|((in12 & 0x00000000000000F0)<<4*2)|((in13 & 0x00000000000000F0)<<4*1)|((in14 & 0x00000000000000F0))|((in15 & 0x00000000000000F0)>>4*1);
*out0=((in0 & 0x000000000000000F)<<4*15)|((in1 & 0x000000000000000F)<<4*14)|((in2 & 0x000000000000000F)<<4*13) | ((in3 & 0x000000000000000F)<<4*12)|((in4 & 0x000000000000000F)<<4*11)| ((in5 & 0x000000000000000F)<<4*10) | ((in6 & 0x000000000000000F)<<4*9)|((in7 & 0x000000000000000F)<<4*8)|((in8 & 0x000000000000000F)<<4*7)|((in9 & 0x000000000000000F)<<4*6)|((in10 & 0x000000000000000F)<<4*5)| ((in11 & 0x000000000000000F)<<4*4)|((in12 & 0x000000000000000F)<<4*3)|((in13 & 0x000000000000000F)<<4*2)|((in14 & 0x000000000000000F)<<4*1)|((in15 & 0x000000000000000F));

}

const unsigned char sbox[16] = {12, 5, 6, 11, 9, 0, 10, 13, 3, 14, 15, 8, 4, 7, 1, 2};
void SubCells(uint64_t *Y)
{
	uint64_t tmp;
	uint64_t x=0;
		tmp = sbox[(*Y>>(60)) & 0xF];
		x = x  |(tmp<<(60));
		tmp = sbox[(*Y>>(56)) & 0xF];
		x = x  |(tmp<<(56));
		tmp = sbox[(*Y>>(52)) & 0xF];
		x = x  |(tmp<<(52));
		tmp = sbox[(*Y>>(48)) & 0xF];
		x = x  |(tmp<<(48));
		tmp = sbox[(*Y>>(44)) & 0xF];
		x = x  |(tmp<<(44));
		tmp = sbox[(*Y>>(40)) & 0xF];
		x = x  |(tmp<<(40));
		tmp = sbox[(*Y>>(36)) & 0xF];
		x = x  |(tmp<<(36));
		tmp = sbox[(*Y>>(32)) & 0xF];
		x = x  |(tmp<<(32));
	    tmp = sbox[(*Y>>(28)) & 0xF];
		x = x  |(tmp<<(28));
		tmp = sbox[(*Y>>(24)) & 0xF];
		x = x  |(tmp<<(24));
		tmp = sbox[(*Y>>(20)) & 0xF];
		x = x  |(tmp<<(20));
		tmp = sbox[(*Y>>(16)) & 0xF];
		x = x  |(tmp<<(16));
		tmp = sbox[(*Y>>(12)) & 0xF];
		x = x  |(tmp<<(12));
		tmp = sbox[(*Y>>(8)) & 0xF];
		x = x  |(tmp<<(8));
		tmp = sbox[(*Y>>(4)) & 0xF];
		x = x  |(tmp<<(4));
		tmp = sbox[(*Y & 0xF)];
		x = x  |(tmp);
	*Y=x;
}


void ShiftRows(uint64_t *Y3, uint64_t *Y2, uint64_t *Y1, uint64_t *Y0, int  n) {
	uint64_t tmp;
if(n==1){
	tmp = *Y3;
	*Y3 = *Y2;
	*Y2 = *Y1;
	*Y1 = *Y0;
	*Y0 = tmp;
}
if(n==2){
		tmp = *Y2;
		*Y2=*Y0;
		*Y0=tmp;
		tmp = *Y3;
		*Y3=*Y1;
		*Y1=tmp;
}
if(n==3){
	tmp = *Y0;
	*Y0=*Y1;
	*Y1=*Y2;
	*Y2=*Y3;
	*Y3=tmp;
}
}



void AddConstants(uint64_t *Y7, uint64_t *Y6, uint64_t *Y5, uint64_t *Y4,uint64_t *Y3, uint64_t *Y2, uint64_t *Y1, uint64_t *Y0, int r) {

	const uint64_t Rc3[48] = {

			0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x1111111111111111, 0x3333333333333333,
			0x7777777777777777, 0x7777777777777777, 0x7777777777777777, 0x6666666666666666, 0x5555555555555555,
			0x3333333333333333, 0x7777777777777777, 0x7777777777777777, 0x6666666666666666, 0x4444444444444444,
            0x1111111111111111, 0x3333333333333333, 0x7777777777777777, 0x6666666666666666, 0x5555555555555555,
			0x2222222222222222, 0x5555555555555555, 0x3333333333333333, 0x6666666666666666, 0x4444444444444444,
			0x0000000000000000, 0x0000000000000000, 0x1111111111111111, 0x2222222222222222, 0x5555555555555555,
			0x3333333333333333, 0x7777777777777777, 0x6666666666666666, 0x4444444444444444, 0x0000000000000000,
			0x1111111111111111, 0x3333333333333333, 0x6666666666666666, 0x5555555555555555, 0x3333333333333333,
			0x6666666666666666, 0x5555555555555555, 0x2222222222222222, 0x4444444444444444, 0x1111111111111111,
			0x2222222222222222, 0x4444444444444444, 0x0000000000000000
		};


	const uint64_t Rc[48] = {

			0x1111111111111111, 0x3333333333333333, 0x7777777777777777, 0x7777777777777777, 0x7777777777777777,
			0x6666666666666666, 0x5555555555555555, 0x3333333333333333, 0x7777777777777777, 0x7777777777777777,
			0x6666666666666666, 0x4444444444444444, 0x1111111111111111, 0x3333333333333333, 0x7777777777777777,
			0x6666666666666666, 0x5555555555555555, 0x2222222222222222, 0x5555555555555555, 0x3333333333333333,
			0x6666666666666666, 0x4444444444444444, 0x0000000000000000, 0x0000000000000000, 0x1111111111111111,
			0x2222222222222222, 0x5555555555555555, 0x3333333333333333, 0x7777777777777777, 0x6666666666666666,
			0x4444444444444444, 0x0000000000000000, 0x1111111111111111, 0x3333333333333333, 0x6666666666666666,
			0x5555555555555555, 0x3333333333333333, 0x6666666666666666, 0x5555555555555555, 0x2222222222222222,
			0x4444444444444444, 0x1111111111111111, 0x2222222222222222, 0x4444444444444444, 0x0000000000000000,
			0x1111111111111111, 0x2222222222222222, 0x4444444444444444
	};

	*Y7 = *Y7^0x4444444444444444;

	*Y5 = *Y5^0x1111111111111111;
	*Y5 = *Y5^0x4444444444444444;

	*Y3 = *Y3^0x2222222222222222;

	*Y1 =*Y1^0x3333333333333333;

	*Y6 = *Y6^Rc3[r];
	*Y4 = *Y4^Rc[r];
	*Y2 = *Y2^Rc3[r];
	*Y0 = *Y0^Rc[r];

}

const unsigned char MixColMatrix[4][4] = {
	{4,  1, 2, 2},
	{8,  6, 5, 6},
	{11,14,10, 9},
	{2,  2,15,11},
};

unsigned char FieldMult(unsigned char a, unsigned char b)
{

	const unsigned char ReductionPoly = 0x3;

	unsigned char x = a, ret = 0;

	int i;

	for(i = 0; i < 4; i++) {

		if((b>>i)&1)
			ret ^= x;


		if(x&0x8) {

			x <<= 1;

			x ^= ReductionPoly;

		}

		else x <<= 1;

	}

	return ret&WORDFILTER;

}



void MixColumn(uint64_t *Y15, uint64_t *Y14, uint64_t *Y13, uint64_t *Y12,uint64_t *Y11, uint64_t *Y10, uint64_t *Y9, uint64_t *Y8,uint64_t *Y7, uint64_t *Y6, uint64_t *Y5, uint64_t *Y4,uint64_t *Y3, uint64_t *Y2, uint64_t *Y1, uint64_t *Y0)
{

	//int j;

	uint64_t tmp1;
	uint64_t tmp2;
	uint64_t tmp3;
	uint64_t tmp4;

	uint64_t sum1;
	uint64_t sum2;
	uint64_t sum3;
	uint64_t sum4;

	uint64_t W=0xF000000000000000;

	//First Nibbles
		tmp1 = (*Y15>>(60))&0xF;
		tmp2 = (*Y11>>(60))&0xF;
		tmp3 = (*Y7>>(60))&0xF;
		tmp4 = (*Y3>>(60))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W));
		*Y15 = *Y15 | (sum1<<(60));
		*Y11 = *Y11 & (~(W));
		*Y11 = *Y11 | (sum2<<(60));
		*Y7 = *Y7 & (~(W));
		*Y7 = *Y7 | (sum3<<(60));
		*Y3 = *Y3 & (~(W));
		*Y3 = *Y3 | (sum4<<(60));
		tmp1 = (*Y14>>(60))&0xF;
		tmp2 = (*Y10>>(60))&0xF;
		tmp3 = (*Y6>>(60))&0xF;
		tmp4 = (*Y2>>(60))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W);
		*Y14 = *Y14 | (sum1<<(60));
		*Y10 = *Y10 & ~(W);
		*Y10 = *Y10 | (sum2<<(60));
		*Y6 = *Y6 & ~(W);
		*Y6 = *Y6 | (sum3<<(60));
		*Y2 = *Y2 & ~(W);
		*Y2 = *Y2 | (sum4<<(60));
		tmp1 = (*Y13>>(60))&0xF;
		tmp2 = (*Y9>>(60))&0xF;
		tmp3 = (*Y5>>(60))&0xF;
		tmp4 = (*Y1>>(60))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W);
		*Y13 = *Y13 | (sum1<<(60));
		*Y9 = *Y9 & ~(W);
		*Y9 = *Y9 | (sum2<<(60));
		*Y5 = *Y5 & ~(W);
		*Y5 = *Y5 | (sum3<<(60));
		*Y1 = *Y1 & ~(W);
		*Y1 = *Y1 | (sum4<<(60));
		tmp1 = (*Y12>>(60))&0xF;
		tmp2 = (*Y8>>(60))&0xF;
		tmp3 = (*Y4>>(60))&0xF;
		tmp4 = (*Y0>>(60))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W);
		*Y12 = *Y12 | (sum1<<(60));
		*Y8 = *Y8 & ~(W);
		*Y8 = *Y8 | (sum2<<(60));
		*Y4 = *Y4 & ~(W);
		*Y4 = *Y4 | (sum3<<(60));
		*Y0 = *Y0 & ~(W);
		*Y0 = *Y0 | (sum4<<(60));
		//Second Nibbles
		tmp1 = (*Y15>>(56))&0xF;
		tmp2 = (*Y11>>(56))&0xF;
		tmp3 = (*Y7>>(56))&0xF;
		tmp4 = (*Y3>>(56))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(4)));
		*Y15 = *Y15 | (sum1<<(56));
		*Y11 = *Y11 & (~(W>>(4)));
		*Y11 = *Y11 | (sum2<<(56));
		*Y7 = *Y7 & (~(W>>(4)));
		*Y7 = *Y7 | (sum3<<(56));
		*Y3 = *Y3 & (~(W>>(4)));
		*Y3 = *Y3 | (sum4<<(56));
		tmp1 = (*Y14>>(56))&0xF;
		tmp2 = (*Y10>>(56))&0xF;
		tmp3 = (*Y6>>(56))&0xF;
		tmp4 = (*Y2>>(56))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(4));
		*Y14 = *Y14 | (sum1<<(56));
		*Y10 = *Y10 & ~(W>>(4));
		*Y10 = *Y10 | (sum2<<(56));
		*Y6 = *Y6 & ~(W>>(4));
		*Y6 = *Y6 | (sum3<<(56));
		*Y2 = *Y2 & ~(W>>(4));
		*Y2 = *Y2 | (sum4<<(56));
		tmp1 = (*Y13>>(56))&0xF;
		tmp2 = (*Y9>>(56))&0xF;
		tmp3 = (*Y5>>(56))&0xF;
		tmp4 = (*Y1>>(56))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(4));
		*Y13 = *Y13 | (sum1<<(56));
		*Y9 = *Y9 & ~(W>>(4));
		*Y9 = *Y9 | (sum2<<(56));
		*Y5 = *Y5 & ~(W>>(4));
		*Y5 = *Y5 | (sum3<<(56));
		*Y1 = *Y1 & ~(W>>(4));
		*Y1 = *Y1 | (sum4<<(56));
		tmp1 = (*Y12>>(56))&0xF;
		tmp2 = (*Y8>>(56))&0xF;
		tmp3 = (*Y4>>(56))&0xF;
		tmp4 = (*Y0>>(56))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(4));
		*Y12 = *Y12 | (sum1<<(56));
		*Y8 = *Y8 & ~(W>>(4));
		*Y8 = *Y8 | (sum2<<(56));
		*Y4 = *Y4 & ~(W>>(4));
		*Y4 = *Y4 | (sum3<<(56));
		*Y0 = *Y0 & ~(W>>(4));
		*Y0 = *Y0 | (sum4<<(56));

		//Third Nibbles
		tmp1 = (*Y15>>(52))&0xF;
		tmp2 = (*Y11>>(52))&0xF;
		tmp3 = (*Y7>>(52))&0xF;
		tmp4 = (*Y3>>(52))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(8)));
		*Y15 = *Y15 | (sum1<<(52));
		*Y11 = *Y11 & (~(W>>(8)));
		*Y11 = *Y11 | (sum2<<(52));
		*Y7 = *Y7 & (~(W>>(8)));
		*Y7 = *Y7 | (sum3<<(52));
		*Y3 = *Y3 & (~(W>>(8)));
		*Y3 = *Y3 | (sum4<<(52));
		tmp1 = (*Y14>>(52))&0xF;
		tmp2 = (*Y10>>(52))&0xF;
		tmp3 = (*Y6>>(52))&0xF;
		tmp4 = (*Y2>>(52))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(8));
		*Y14 = *Y14 | (sum1<<(52));
		*Y10 = *Y10 & ~(W>>(8));
		*Y10 = *Y10 | (sum2<<(52));
		*Y6 = *Y6 & ~(W>>(8));
		*Y6 = *Y6 | (sum3<<(52));
		*Y2 = *Y2 & ~(W>>(8));
		*Y2 = *Y2 | (sum4<<(52));
		tmp1 = (*Y13>>(52))&0xF;
		tmp2 = (*Y9>>(52))&0xF;
		tmp3 = (*Y5>>(52))&0xF;
		tmp4 = (*Y1>>(52))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(8));
		*Y13 = *Y13 | (sum1<<(52));
		*Y9 = *Y9 & ~(W>>(8));
		*Y9 = *Y9 | (sum2<<(52));
		*Y5 = *Y5 & ~(W>>(8));
		*Y5 = *Y5 | (sum3<<(52));
		*Y1 = *Y1 & ~(W>>(8));
		*Y1 = *Y1 | (sum4<<(52));
		tmp1 = (*Y12>>(52))&0xF;
		tmp2 = (*Y8>>(52))&0xF;
		tmp3 = (*Y4>>(52))&0xF;
		tmp4 = (*Y0>>(52))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(8));
		*Y12 = *Y12 | (sum1<<(52));
		*Y8 = *Y8 & ~(W>>(8));
		*Y8 = *Y8 | (sum2<<(52));
		*Y4 = *Y4 & ~(W>>(8));
		*Y4 = *Y4 | (sum3<<(52));
		*Y0 = *Y0 & ~(W>>(8));
		*Y0 = *Y0 | (sum4<<(52));

		//Fourth Nibbles
		tmp1 = (*Y15>>(48))&0xF;
		tmp2 = (*Y11>>(48))&0xF;
		tmp3 = (*Y7>>(48))&0xF;
		tmp4 = (*Y3>>(48))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(12)));
		*Y15 = *Y15 | (sum1<<(48));
		*Y11 = *Y11 & (~(W>>(12)));
		*Y11 = *Y11 | (sum2<<(48));
		*Y7 = *Y7 & (~(W>>(12)));
		*Y7 = *Y7 | (sum3<<(48));
		*Y3 = *Y3 & (~(W>>(12)));
		*Y3 = *Y3 | (sum4<<(48));
		tmp1 = (*Y14>>(48))&0xF;
		tmp2 = (*Y10>>(48))&0xF;
		tmp3 = (*Y6>>(48))&0xF;
		tmp4 = (*Y2>>(48))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(12));
		*Y14 = *Y14 | (sum1<<(48));
		*Y10 = *Y10 & ~(W>>(12));
		*Y10 = *Y10 | (sum2<<(48));
		*Y6 = *Y6 & ~(W>>(12));
		*Y6 = *Y6 | (sum3<<(48));
		*Y2 = *Y2 & ~(W>>(12));
		*Y2 = *Y2 | (sum4<<(48));
		tmp1 = (*Y13>>(48))&0xF;
		tmp2 = (*Y9>>(48))&0xF;
		tmp3 = (*Y5>>(48))&0xF;
		tmp4 = (*Y1>>(48))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(12));
		*Y13 = *Y13 | (sum1<<(48));
		*Y9 = *Y9 & ~(W>>(12));
		*Y9 = *Y9 | (sum2<<(48));
		*Y5 = *Y5 & ~(W>>(12));
		*Y5 = *Y5 | (sum3<<(48));
		*Y1 = *Y1 & ~(W>>(12));
		*Y1 = *Y1 | (sum4<<(48));
		tmp1 = (*Y12>>(48))&0xF;
		tmp2 = (*Y8>>(48))&0xF;
		tmp3 = (*Y4>>(48))&0xF;
		tmp4 = (*Y0>>(48))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(12));
		*Y12 = *Y12 | (sum1<<(48));
		*Y8 = *Y8 & ~(W>>(12));
		*Y8 = *Y8 | (sum2<<(48));
		*Y4 = *Y4 & ~(W>>(12));
		*Y4 = *Y4 | (sum3<<(48));
		*Y0 = *Y0 & ~(W>>(12));
		*Y0 = *Y0 | (sum4<<(48));

		//Fifth Nibbles
		tmp1 = (*Y15>>(44))&0xF;
		tmp2 = (*Y11>>(44))&0xF;
		tmp3 = (*Y7>>(44))&0xF;
		tmp4 = (*Y3>>(44))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(16)));
		*Y15 = *Y15 | (sum1<<(44));
		*Y11 = *Y11 & (~(W>>(16)));
		*Y11 = *Y11 | (sum2<<(44));
		*Y7 = *Y7 & (~(W>>(16)));
		*Y7 = *Y7 | (sum3<<(44));
		*Y3 = *Y3 & (~(W>>(16)));
		*Y3 = *Y3 | (sum4<<(44));
		tmp1 = (*Y14>>(44))&0xF;
		tmp2 = (*Y10>>(44))&0xF;
		tmp3 = (*Y6>>(44))&0xF;
		tmp4 = (*Y2>>(44))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(16));
		*Y14 = *Y14 | (sum1<<(44));
		*Y10 = *Y10 & ~(W>>(16));
		*Y10 = *Y10 | (sum2<<(44));
		*Y6 = *Y6 & ~(W>>(16));
		*Y6 = *Y6 | (sum3<<(44));
		*Y2 = *Y2 & ~(W>>(16));
		*Y2 = *Y2 | (sum4<<(44));
		tmp1 = (*Y13>>(44))&0xF;
		tmp2 = (*Y9>>(44))&0xF;
		tmp3 = (*Y5>>(44))&0xF;
		tmp4 = (*Y1>>(44))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(16));
		*Y13 = *Y13 | (sum1<<(44));
		*Y9 = *Y9 & ~(W>>(16));
		*Y9 = *Y9 | (sum2<<(44));
		*Y5 = *Y5 & ~(W>>(16));
		*Y5 = *Y5 | (sum3<<(44));
		*Y1 = *Y1 & ~(W>>(16));
		*Y1 = *Y1 | (sum4<<(44));
		tmp1 = (*Y12>>(44))&0xF;
		tmp2 = (*Y8>>(44))&0xF;
		tmp3 = (*Y4>>(44))&0xF;
		tmp4 = (*Y0>>(44))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(16));
		*Y12 = *Y12 | (sum1<<(44));
		*Y8 = *Y8 & ~(W>>(16));
		*Y8 = *Y8 | (sum2<<(44));
		*Y4 = *Y4 & ~(W>>(16));
		*Y4 = *Y4 | (sum3<<(44));
		*Y0 = *Y0 & ~(W>>(16));
		*Y0 = *Y0 | (sum4<<(44));

		//Sixth Nibbles
		tmp1 = (*Y15>>(40))&0xF;
		tmp2 = (*Y11>>(40))&0xF;
		tmp3 = (*Y7>>(40))&0xF;
		tmp4 = (*Y3>>(40))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(20)));
		*Y15 = *Y15 | (sum1<<(40));
		*Y11 = *Y11 & (~(W>>(20)));
		*Y11 = *Y11 | (sum2<<(40));
		*Y7 = *Y7 & (~(W>>(20)));
		*Y7 = *Y7 | (sum3<<(40));
		*Y3 = *Y3 & (~(W>>(20)));
		*Y3 = *Y3 | (sum4<<(40));
		tmp1 = (*Y14>>(40))&0xF;
		tmp2 = (*Y10>>(40))&0xF;
		tmp3 = (*Y6>>(40))&0xF;
		tmp4 = (*Y2>>(40))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(20));
		*Y14 = *Y14 | (sum1<<(40));
		*Y10 = *Y10 & ~(W>>(20));
		*Y10 = *Y10 | (sum2<<(40));
		*Y6 = *Y6 & ~(W>>(20));
		*Y6 = *Y6 | (sum3<<(40));
		*Y2 = *Y2 & ~(W>>(20));
		*Y2 = *Y2 | (sum4<<(40));
		tmp1 = (*Y13>>(40))&0xF;
		tmp2 = (*Y9>>(40))&0xF;
		tmp3 = (*Y5>>(40))&0xF;
		tmp4 = (*Y1>>(40))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(20));
		*Y13 = *Y13 | (sum1<<(40));
		*Y9 = *Y9 & ~(W>>(20));
		*Y9 = *Y9 | (sum2<<(40));
		*Y5 = *Y5 & ~(W>>(20));
		*Y5 = *Y5 | (sum3<<(40));
		*Y1 = *Y1 & ~(W>>(20));
		*Y1 = *Y1 | (sum4<<(40));
		tmp1 = (*Y12>>(40))&0xF;
		tmp2 = (*Y8>>(40))&0xF;
		tmp3 = (*Y4>>(40))&0xF;
		tmp4 = (*Y0>>(40))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(20));
		*Y12 = *Y12 | (sum1<<(40));
		*Y8 = *Y8 & ~(W>>(20));
		*Y8 = *Y8 | (sum2<<(40));
		*Y4 = *Y4 & ~(W>>(20));
		*Y4 = *Y4 | (sum3<<(40));
		*Y0 = *Y0 & ~(W>>(20));
		*Y0 = *Y0 | (sum4<<(40));

		//Seventh Nibbles
		tmp1 = (*Y15>>(36))&0xF;
		tmp2 = (*Y11>>(36))&0xF;
		tmp3 = (*Y7>>(36))&0xF;
		tmp4 = (*Y3>>(36))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(24)));
		*Y15 = *Y15 | (sum1<<(36));
		*Y11 = *Y11 & (~(W>>(24)));
		*Y11 = *Y11 | (sum2<<(36));
		*Y7 = *Y7 & (~(W>>(24)));
		*Y7 = *Y7 | (sum3<<(36));
		*Y3 = *Y3 & (~(W>>(24)));
		*Y3 = *Y3 | (sum4<<(36));
		tmp1 = (*Y14>>(36))&0xF;
		tmp2 = (*Y10>>(36))&0xF;
		tmp3 = (*Y6>>(36))&0xF;
		tmp4 = (*Y2>>(36))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(24));
		*Y14 = *Y14 | (sum1<<(36));
		*Y10 = *Y10 & ~(W>>(24));
		*Y10 = *Y10 | (sum2<<(36));
		*Y6 = *Y6 & ~(W>>(24));
		*Y6 = *Y6 | (sum3<<(36));
		*Y2 = *Y2 & ~(W>>(24));
		*Y2 = *Y2 | (sum4<<(36));
		tmp1 = (*Y13>>(36))&0xF;
		tmp2 = (*Y9>>(36))&0xF;
		tmp3 = (*Y5>>(36))&0xF;
		tmp4 = (*Y1>>(36))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(24));
		*Y13 = *Y13 | (sum1<<(36));
		*Y9 = *Y9 & ~(W>>(24));
		*Y9 = *Y9 | (sum2<<(36));
		*Y5 = *Y5 & ~(W>>(24));
		*Y5 = *Y5 | (sum3<<(36));
		*Y1 = *Y1 & ~(W>>(24));
		*Y1 = *Y1 | (sum4<<(36));
		tmp1 = (*Y12>>(36))&0xF;
		tmp2 = (*Y8>>(36))&0xF;
		tmp3 = (*Y4>>(36))&0xF;
		tmp4 = (*Y0>>(36))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(24));
		*Y12 = *Y12 | (sum1<<(36));
		*Y8 = *Y8 & ~(W>>(24));
		*Y8 = *Y8 | (sum2<<(36));
		*Y4 = *Y4 & ~(W>>(24));
		*Y4 = *Y4 | (sum3<<(36));
		*Y0 = *Y0 & ~(W>>(24));
		*Y0 = *Y0 | (sum4<<(36));

		//Eighth Nibbles
		tmp1 = (*Y15>>(32))&0xF;
		tmp2 = (*Y11>>(32))&0xF;
		tmp3 = (*Y7>>(32))&0xF;
		tmp4 = (*Y3>>(32))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(28)));
		*Y15 = *Y15 | (sum1<<(32));
		*Y11 = *Y11 & (~(W>>(28)));
		*Y11 = *Y11 | (sum2<<(32));
		*Y7 = *Y7 & (~(W>>(28)));
		*Y7 = *Y7 | (sum3<<(32));
		*Y3 = *Y3 & (~(W>>(28)));
		*Y3 = *Y3 | (sum4<<(32));
		tmp1 = (*Y14>>(32))&0xF;
		tmp2 = (*Y10>>(32))&0xF;
		tmp3 = (*Y6>>(32))&0xF;
		tmp4 = (*Y2>>(32))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(28));
		*Y14 = *Y14 | (sum1<<(32));
		*Y10 = *Y10 & ~(W>>(28));
		*Y10 = *Y10 | (sum2<<(32));
		*Y6 = *Y6 & ~(W>>(28));
		*Y6 = *Y6 | (sum3<<(32));
		*Y2 = *Y2 & ~(W>>(28));
		*Y2 = *Y2 | (sum4<<(32));
		tmp1 = (*Y13>>(32))&0xF;
		tmp2 = (*Y9>>(32))&0xF;
		tmp3 = (*Y5>>(32))&0xF;
		tmp4 = (*Y1>>(32))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(28));
		*Y13 = *Y13 | (sum1<<(32));
		*Y9 = *Y9 & ~(W>>(28));
		*Y9 = *Y9 | (sum2<<(32));
		*Y5 = *Y5 & ~(W>>(28));
		*Y5 = *Y5 | (sum3<<(32));
		*Y1 = *Y1 & ~(W>>(28));
		*Y1 = *Y1 | (sum4<<(32));
		tmp1 = (*Y12>>(32))&0xF;
		tmp2 = (*Y8>>(32))&0xF;
		tmp3 = (*Y4>>(32))&0xF;
		tmp4 = (*Y0>>(32))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(28));
		*Y12 = *Y12 | (sum1<<(32));
		*Y8 = *Y8 & ~(W>>(28));
		*Y8 = *Y8 | (sum2<<(32));
		*Y4 = *Y4 & ~(W>>(28));
		*Y4 = *Y4 | (sum3<<(32));
		*Y0 = *Y0 & ~(W>>(28));
		*Y0 = *Y0 | (sum4<<(32));

		//Ninth Nibbles
		tmp1 = (*Y15>>(28))&0xF;
		tmp2 = (*Y11>>(28))&0xF;
		tmp3 = (*Y7>>(28))&0xF;
		tmp4 = (*Y3>>(28))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(32)));
		*Y15 = *Y15 | (sum1<<(28));
		*Y11 = *Y11 & (~(W>>(32)));
		*Y11 = *Y11 | (sum2<<(28));
		*Y7 = *Y7 & (~(W>>(32)));
		*Y7 = *Y7 | (sum3<<(28));
		*Y3 = *Y3 & (~(W>>(32)));
		*Y3 = *Y3 | (sum4<<(28));
		tmp1 = (*Y14>>(28))&0xF;
		tmp2 = (*Y10>>(28))&0xF;
		tmp3 = (*Y6>>(28))&0xF;
		tmp4 = (*Y2>>(28))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(32));
		*Y14 = *Y14 | (sum1<<(28));
		*Y10 = *Y10 & ~(W>>(32));
		*Y10 = *Y10 | (sum2<<(28));
		*Y6 = *Y6 & ~(W>>(32));
		*Y6 = *Y6 | (sum3<<(28));
		*Y2 = *Y2 & ~(W>>(32));
		*Y2 = *Y2 | (sum4<<(28));
		tmp1 = (*Y13>>(28))&0xF;
		tmp2 = (*Y9>>(28))&0xF;
		tmp3 = (*Y5>>(28))&0xF;
		tmp4 = (*Y1>>(28))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(32));
		*Y13 = *Y13 | (sum1<<(28));
		*Y9 = *Y9 & ~(W>>(32));
		*Y9 = *Y9 | (sum2<<(28));
		*Y5 = *Y5 & ~(W>>(32));
		*Y5 = *Y5 | (sum3<<(28));
		*Y1 = *Y1 & ~(W>>(32));
		*Y1 = *Y1 | (sum4<<(28));
		tmp1 = (*Y12>>(28))&0xF;
		tmp2 = (*Y8>>(28))&0xF;
		tmp3 = (*Y4>>(28))&0xF;
		tmp4 = (*Y0>>(28))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(32));
		*Y12 = *Y12 | (sum1<<(28));
		*Y8 = *Y8 & ~(W>>(32));
		*Y8 = *Y8 | (sum2<<(28));
		*Y4 = *Y4 & ~(W>>(32));
		*Y4 = *Y4 | (sum3<<(28));
		*Y0 = *Y0 & ~(W>>(32));
		*Y0 = *Y0 | (sum4<<(28));

		//Tenth Nibbles
		tmp1 = (*Y15>>(24))&0xF;
		tmp2 = (*Y11>>(24))&0xF;
		tmp3 = (*Y7>>(24))&0xF;
		tmp4 = (*Y3>>(24))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(36)));
		*Y15 = *Y15 | (sum1<<(24));
		*Y11 = *Y11 & (~(W>>(36)));
		*Y11 = *Y11 | (sum2<<(24));
		*Y7 = *Y7 & (~(W>>(36)));
		*Y7 = *Y7 | (sum3<<(24));
		*Y3 = *Y3 & (~(W>>(36)));
		*Y3 = *Y3 | (sum4<<(24));
		tmp1 = (*Y14>>(24))&0xF;
		tmp2 = (*Y10>>(24))&0xF;
		tmp3 = (*Y6>>(24))&0xF;
		tmp4 = (*Y2>>(24))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(36));
		*Y14 = *Y14 | (sum1<<(24));
		*Y10 = *Y10 & ~(W>>(36));
		*Y10 = *Y10 | (sum2<<(24));
		*Y6 = *Y6 & ~(W>>(36));
		*Y6 = *Y6 | (sum3<<(24));
		*Y2 = *Y2 & ~(W>>(36));
		*Y2 = *Y2 | (sum4<<(24));
		tmp1 = (*Y13>>(24))&0xF;
		tmp2 = (*Y9>>(24))&0xF;
		tmp3 = (*Y5>>(24))&0xF;
		tmp4 = (*Y1>>(24))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(36));
		*Y13 = *Y13 | (sum1<<(24));
		*Y9 = *Y9 & ~(W>>(36));
		*Y9 = *Y9 | (sum2<<(24));
		*Y5 = *Y5 & ~(W>>(36));
		*Y5 = *Y5 | (sum3<<(24));
		*Y1 = *Y1 & ~(W>>(36));
		*Y1 = *Y1 | (sum4<<(24));
		tmp1 = (*Y12>>(24))&0xF;
		tmp2 = (*Y8>>(24))&0xF;
		tmp3 = (*Y4>>(24))&0xF;
		tmp4 = (*Y0>>(24))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(36));
		*Y12 = *Y12 | (sum1<<(24));
		*Y8 = *Y8 & ~(W>>(36));
		*Y8 = *Y8 | (sum2<<(24));
		*Y4 = *Y4 & ~(W>>(36));
		*Y4 = *Y4 | (sum3<<(24));
		*Y0 = *Y0 & ~(W>>(36));
		*Y0 = *Y0 | (sum4<<(24));

		//Eleventh Nibbles
		tmp1 = (*Y15>>(20))&0xF;
		tmp2 = (*Y11>>(20))&0xF;
		tmp3 = (*Y7>>(20))&0xF;
		tmp4 = (*Y3>>(20))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(40)));
		*Y15 = *Y15 | (sum1<<(20));
		*Y11 = *Y11 & (~(W>>(40)));
		*Y11 = *Y11 | (sum2<<(20));
		*Y7 = *Y7 & (~(W>>(40)));
		*Y7 = *Y7 | (sum3<<(20));
		*Y3 = *Y3 & (~(W>>(40)));
		*Y3 = *Y3 | (sum4<<(20));
		tmp1 = (*Y14>>(20))&0xF;
		tmp2 = (*Y10>>(20))&0xF;
		tmp3 = (*Y6>>(20))&0xF;
		tmp4 = (*Y2>>(20))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(40));
		*Y14 = *Y14 | (sum1<<(20));
		*Y10 = *Y10 & ~(W>>(40));
		*Y10 = *Y10 | (sum2<<(20));
		*Y6 = *Y6 & ~(W>>(40));
		*Y6 = *Y6 | (sum3<<(20));
		*Y2 = *Y2 & ~(W>>(40));
		*Y2 = *Y2 | (sum4<<(20));
		tmp1 = (*Y13>>(20))&0xF;
		tmp2 = (*Y9>>(20))&0xF;
		tmp3 = (*Y5>>(20))&0xF;
		tmp4 = (*Y1>>(20))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(40));
		*Y13 = *Y13 | (sum1<<(20));
		*Y9 = *Y9 & ~(W>>(40));
		*Y9 = *Y9 | (sum2<<(20));
		*Y5 = *Y5 & ~(W>>(40));
		*Y5 = *Y5 | (sum3<<(20));
		*Y1 = *Y1 & ~(W>>(40));
		*Y1 = *Y1 | (sum4<<(20));
		tmp1 = (*Y12>>(20))&0xF;
		tmp2 = (*Y8>>(20))&0xF;
		tmp3 = (*Y4>>(20))&0xF;
		tmp4 = (*Y0>>(20))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(40));
		*Y12 = *Y12 | (sum1<<(20));
		*Y8 = *Y8 & ~(W>>(40));
		*Y8 = *Y8 | (sum2<<(20));
		*Y4 = *Y4 & ~(W>>(40));
		*Y4 = *Y4 | (sum3<<(20));
		*Y0 = *Y0 & ~(W>>(40));
		*Y0 = *Y0 | (sum4<<(20));

		//Twelfth Nibbles
		tmp1 = (*Y15>>(16))&0xF;
		tmp2 = (*Y11>>(16))&0xF;
		tmp3 = (*Y7>>(16))&0xF;
		tmp4 = (*Y3>>(16))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(44)));
		*Y15 = *Y15 | (sum1<<(16));
		*Y11 = *Y11 & (~(W>>(44)));
		*Y11 = *Y11 | (sum2<<(16));
		*Y7 = *Y7 & (~(W>>(44)));
		*Y7 = *Y7 | (sum3<<(16));
		*Y3 = *Y3 & (~(W>>(44)));
		*Y3 = *Y3 | (sum4<<(16));
		tmp1 = (*Y14>>(16))&0xF;
		tmp2 = (*Y10>>(16))&0xF;
		tmp3 = (*Y6>>(16))&0xF;
		tmp4 = (*Y2>>(16))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(44));
		*Y14 = *Y14 | (sum1<<(16));
		*Y10 = *Y10 & ~(W>>(44));
		*Y10 = *Y10 | (sum2<<(16));
		*Y6 = *Y6 & ~(W>>(44));
		*Y6 = *Y6 | (sum3<<(16));
		*Y2 = *Y2 & ~(W>>(44));
		*Y2 = *Y2 | (sum4<<(16));
		tmp1 = (*Y13>>(16))&0xF;
		tmp2 = (*Y9>>(16))&0xF;
		tmp3 = (*Y5>>(16))&0xF;
		tmp4 = (*Y1>>(16))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(44));
		*Y13 = *Y13 | (sum1<<(16));
		*Y9 = *Y9 & ~(W>>(44));
		*Y9 = *Y9 | (sum2<<(16));
		*Y5 = *Y5 & ~(W>>(44));
		*Y5 = *Y5 | (sum3<<(16));
		*Y1 = *Y1 & ~(W>>(44));
		*Y1 = *Y1 | (sum4<<(16));
		tmp1 = (*Y12>>(16))&0xF;
		tmp2 = (*Y8>>(16))&0xF;
		tmp3 = (*Y4>>(16))&0xF;
		tmp4 = (*Y0>>(16))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(44));
		*Y12 = *Y12 | (sum1<<(16));
		*Y8 = *Y8 & ~(W>>(44));
		*Y8 = *Y8 | (sum2<<(16));
		*Y4 = *Y4 & ~(W>>(44));
		*Y4 = *Y4 | (sum3<<(16));
		*Y0 = *Y0 & ~(W>>(44));
		*Y0 = *Y0 | (sum4<<(16));

		//Thirteenth Nibbles
		tmp1 = (*Y15>>(12))&0xF;
		tmp2 = (*Y11>>(12))&0xF;
		tmp3 = (*Y7>>(12))&0xF;
		tmp4 = (*Y3>>(12))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(48)));
		*Y15 = *Y15 | (sum1<<(12));
		*Y11 = *Y11 & (~(W>>(48)));
		*Y11 = *Y11 | (sum2<<(12));
		*Y7 = *Y7 & (~(W>>(48)));
		*Y7 = *Y7 | (sum3<<(12));
		*Y3 = *Y3 & (~(W>>(48)));
		*Y3 = *Y3 | (sum4<<(12));
		tmp1 = (*Y14>>(12))&0xF;
		tmp2 = (*Y10>>(12))&0xF;
		tmp3 = (*Y6>>(12))&0xF;
		tmp4 = (*Y2>>(12))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(48));
		*Y14 = *Y14 | (sum1<<(12));
		*Y10 = *Y10 & ~(W>>(48));
		*Y10 = *Y10 | (sum2<<(12));
		*Y6 = *Y6 & ~(W>>(48));
		*Y6 = *Y6 | (sum3<<(12));
		*Y2 = *Y2 & ~(W>>(48));
		*Y2 = *Y2 | (sum4<<(12));
		tmp1 = (*Y13>>(12))&0xF;
		tmp2 = (*Y9>>(12))&0xF;
		tmp3 = (*Y5>>(12))&0xF;
		tmp4 = (*Y1>>(12))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(48));
		*Y13 = *Y13 | (sum1<<(12));
		*Y9 = *Y9 & ~(W>>(48));
		*Y9 = *Y9 | (sum2<<(12));
		*Y5 = *Y5 & ~(W>>(48));
		*Y5 = *Y5 | (sum3<<(12));
		*Y1 = *Y1 & ~(W>>(48));
		*Y1 = *Y1 | (sum4<<(12));
		tmp1 = (*Y12>>(12))&0xF;
		tmp2 = (*Y8>>(12))&0xF;
		tmp3 = (*Y4>>(12))&0xF;
		tmp4 = (*Y0>>(12))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(48));
		*Y12 = *Y12 | (sum1<<(12));
		*Y8 = *Y8 & ~(W>>(48));
		*Y8 = *Y8 | (sum2<<(12));
		*Y4 = *Y4 & ~(W>>(48));
		*Y4 = *Y4 | (sum3<<(12));
		*Y0 = *Y0 & ~(W>>(48));
		*Y0 = *Y0 | (sum4<<(12));


		//Fourteenth Nibbles
		tmp1 = (*Y15>>(8))&0xF;
		tmp2 = (*Y11>>(8))&0xF;
		tmp3 = (*Y7>>(8))&0xF;
		tmp4 = (*Y3>>(8))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(52)));
		*Y15 = *Y15 | (sum1<<(8));
		*Y11 = *Y11 & (~(W>>(52)));
		*Y11 = *Y11 | (sum2<<(8));
		*Y7 = *Y7 & (~(W>>(52)));
		*Y7 = *Y7 | (sum3<<(8));
		*Y3 = *Y3 & (~(W>>(52)));
		*Y3 = *Y3 | (sum4<<(8));
		tmp1 = (*Y14>>(8))&0xF;
		tmp2 = (*Y10>>(8))&0xF;
		tmp3 = (*Y6>>(8))&0xF;
		tmp4 = (*Y2>>(8))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(52));
		*Y14 = *Y14 | (sum1<<(8));
		*Y10 = *Y10 & ~(W>>(52));
		*Y10 = *Y10 | (sum2<<(8));
		*Y6 = *Y6 & ~(W>>(52));
		*Y6 = *Y6 | (sum3<<(8));
		*Y2 = *Y2 & ~(W>>(52));
		*Y2 = *Y2 | (sum4<<(8));
		tmp1 = (*Y13>>(8))&0xF;
		tmp2 = (*Y9>>(8))&0xF;
		tmp3 = (*Y5>>(8))&0xF;
		tmp4 = (*Y1>>(8))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(52));
		*Y13 = *Y13 | (sum1<<(8));
		*Y9 = *Y9 & ~(W>>(52));
		*Y9 = *Y9 | (sum2<<(8));
		*Y5 = *Y5 & ~(W>>(52));
		*Y5 = *Y5 | (sum3<<(8));
		*Y1 = *Y1 & ~(W>>(52));
		*Y1 = *Y1 | (sum4<<(8));
		tmp1 = (*Y12>>(8))&0xF;
		tmp2 = (*Y8>>(8))&0xF;
		tmp3 = (*Y4>>(8))&0xF;
		tmp4 = (*Y0>>(8))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(52));
		*Y12 = *Y12 | (sum1<<(8));
		*Y8 = *Y8 & ~(W>>(52));
		*Y8 = *Y8 | (sum2<<(8));
		*Y4 = *Y4 & ~(W>>(52));
		*Y4 = *Y4 | (sum3<<(8));
		*Y0 = *Y0 & ~(W>>(52));
		*Y0 = *Y0 | (sum4<<(8));

		//Fifteenth Nibbles
		tmp1 = (*Y15>>(4))&0xF;
		tmp2 = (*Y11>>(4))&0xF;
		tmp3 = (*Y7>>(4))&0xF;
		tmp4 = (*Y3>>(4))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(56)));
		*Y15 = *Y15 | (sum1<<(4));
		*Y11 = *Y11 & (~(W>>(56)));
		*Y11 = *Y11 | (sum2<<(4));
		*Y7 = *Y7 & (~(W>>(56)));
		*Y7 = *Y7 | (sum3<<(4));
		*Y3 = *Y3 & (~(W>>(56)));
		*Y3 = *Y3 | (sum4<<(4));
		tmp1 = (*Y14>>(4))&0xF;
		tmp2 = (*Y10>>(4))&0xF;
		tmp3 = (*Y6>>(4))&0xF;
		tmp4 = (*Y2>>(4))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(56));
		*Y14 = *Y14 | (sum1<<(4));
		*Y10 = *Y10 & ~(W>>(56));
		*Y10 = *Y10 | (sum2<<(4));
		*Y6 = *Y6 & ~(W>>(56));
		*Y6 = *Y6 | (sum3<<(4));
		*Y2 = *Y2 & ~(W>>(56));
		*Y2 = *Y2 | (sum4<<(4));
		tmp1 = (*Y13>>(4))&0xF;
		tmp2 = (*Y9>>(4))&0xF;
		tmp3 = (*Y5>>(4))&0xF;
		tmp4 = (*Y1>>(4))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(56));
		*Y13 = *Y13 | (sum1<<(4));
		*Y9 = *Y9 & ~(W>>(56));
		*Y9 = *Y9 | (sum2<<(4));
		*Y5 = *Y5 & ~(W>>(56));
		*Y5 = *Y5 | (sum3<<(4));
		*Y1 = *Y1 & ~(W>>(56));
		*Y1 = *Y1 | (sum4<<(4));
		tmp1 = (*Y12>>(4))&0xF;
		tmp2 = (*Y8>>(4))&0xF;
		tmp3 = (*Y4>>(4))&0xF;
		tmp4 = (*Y0>>(4))&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(56));
		*Y12 = *Y12 | (sum1<<(4));
		*Y8 = *Y8 & ~(W>>(56));
		*Y8 = *Y8 | (sum2<<(4));
		*Y4 = *Y4 & ~(W>>(56));
		*Y4 = *Y4 | (sum3<<(4));
		*Y0 = *Y0 & ~(W>>(56));
		*Y0 = *Y0 | (sum4<<(4));

		//Sixteenth Nibbles
		tmp1 = (*Y15)&0xF;
		tmp2 = (*Y11)&0xF;
		tmp3 = (*Y7)&0xF;
		tmp4 = (*Y3)&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y15 = *Y15 & (~(W>>(60)));
		*Y15 = *Y15 | (sum1);
		*Y11 = *Y11 & (~(W>>(60)));
		*Y11 = *Y11 | (sum2);
		*Y7 = *Y7 & (~(W>>(60)));
		*Y7 = *Y7 | (sum3);
		*Y3 = *Y3 & (~(W>>(60)));
		*Y3 = *Y3 | (sum4);
		tmp1 = (*Y14)&0xF;
		tmp2 = (*Y10)&0xF;
		tmp3 = (*Y6)&0xF;
		tmp4 = (*Y2)&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y14 = *Y14 & ~(W>>(60));
		*Y14 = *Y14 | (sum1);
		*Y10 = *Y10 & ~(W>>(60));
		*Y10 = *Y10 | (sum2);
		*Y6 = *Y6 & ~(W>>(60));
		*Y6 = *Y6 | (sum3);
		*Y2 = *Y2 & ~(W>>(60));
		*Y2 = *Y2 | (sum4);
		tmp1 = (*Y13)&0xF;
		tmp2 = (*Y9)&0xF;
		tmp3 = (*Y5)&0xF;
		tmp4 = (*Y1)&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y13 = *Y13 & ~(W>>(60));
		*Y13 = *Y13 | (sum1);
		*Y9 = *Y9 & ~(W>>(60));
		*Y9 = *Y9 | (sum2);
		*Y5 = *Y5 & ~(W>>(60));
		*Y5 = *Y5 | (sum3);
		*Y1 = *Y1 & ~(W>>(60));
		*Y1 = *Y1 | (sum4);
		tmp1 = (*Y12)&0xF;
		tmp2 = (*Y8)&0xF;
		tmp3 = (*Y4)&0xF;
		tmp4 = (*Y0)&0xF;
		sum1 = FieldMult(MixColMatrix[0][0],tmp1) ^ FieldMult(MixColMatrix[0][1],tmp2)^ FieldMult(MixColMatrix[0][2],tmp3) ^ FieldMult(MixColMatrix[0][3],tmp4);
		sum2 = FieldMult(MixColMatrix[1][0],tmp1) ^ FieldMult(MixColMatrix[1][1],tmp2) ^ FieldMult(MixColMatrix[1][2],tmp3) ^FieldMult(MixColMatrix[1][3],tmp4);
		sum3 = FieldMult(MixColMatrix[2][0],tmp1) ^ FieldMult(MixColMatrix[2][1],tmp2) ^ FieldMult(MixColMatrix[2][2],tmp3) ^ FieldMult(MixColMatrix[2][3],tmp4);
		sum4 = FieldMult(MixColMatrix[3][0],tmp1) ^ FieldMult(MixColMatrix[3][1],tmp2) ^ FieldMult(MixColMatrix[3][2],tmp3) ^ FieldMult(MixColMatrix[3][3],tmp4);
		*Y12 = *Y12 & ~(W>>(60));
		*Y12 = *Y12 | (sum1);
		*Y8 = *Y8 & ~(W>>(60));
		*Y8 = *Y8 | (sum2);
		*Y4 = *Y4 & ~(W>>(60));
		*Y4 = *Y4 | (sum3);
		*Y0 = *Y0 & ~(W>>(60));
		*Y0 = *Y0 | (sum4);


}



//void AddKey(uint64_t *X, uint64_t *K) {
	//*X=*X^*K;
//}


void encrypt(uint64_t *Y15, uint64_t *Y14, uint64_t *Y13, uint64_t *Y12,uint64_t *Y11, uint64_t *Y10, uint64_t *Y9, uint64_t *Y8,uint64_t *Y7, uint64_t *Y6, uint64_t *Y5, uint64_t *Y4,uint64_t *Y3, uint64_t *Y2, uint64_t *Y1, uint64_t *Y0,uint64_t *key15,uint64_t *key14,uint64_t *key13,uint64_t *key12,uint64_t *key11,uint64_t *key10,uint64_t *key9,uint64_t *key8,uint64_t *key7,uint64_t *key6,uint64_t *key5,uint64_t *key4,uint64_t *key3,uint64_t *key2,uint64_t *key1,uint64_t *key0) {
  //int i;
    		//AddKey(Y15, key15);
    		//AddKey(Y14, key14);
    		//AddKey(Y13, key13);
    		//AddKey(Y12, key12);
    		//AddKey(Y11, key11);
    		//AddKey(Y10, key10);
    		//AddKey(Y9,  key9);
    		//AddKey(Y8,  key8);
    		//AddKey(Y7,  key7);
    		//AddKey(Y6,  key6);
    		//AddKey(Y5,  key5);
    		//AddKey(Y4,  key4);
    		//AddKey(Y3,  key3);
    		//AddKey(Y2,  key2);
    		//AddKey(Y1,  key1);
    		//AddKey(Y0,  key0);

  	  	  *Y15 = *Y15 ^ *key15;
  	  	  *Y14 = *Y14 ^ *key14;
  	  	  *Y13 = *Y13 ^ *key13;
  	  	  *Y12 = *Y12 ^ *key12;
  	  	  *Y11 = *Y11 ^ *key11;
  	  	  *Y10 = *Y10 ^ *key10;
  	  	  *Y9 = *Y9 ^ *key9;
  	  	  *Y8 = *Y8 ^ *key8;
  	  	  *Y7 = *Y7 ^ *key7;
  	  	  *Y6 = *Y6 ^ *key6;
  	  	  *Y5 = *Y5 ^ *key5;
  	  	  *Y4 = *Y4 ^ *key4;
  	  	  *Y3 = *Y3 ^ *key3;
  	  	  *Y2 = *Y2 ^ *key2;
  	  	  *Y1 = *Y1 ^ *key1;
  	  	  *Y0 = *Y0 ^ *key0;

	  //First round
		  AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,0);
     	  SubCells(Y15);
		  SubCells(Y14);
		  SubCells(Y13);
		  SubCells(Y12);
		  SubCells(Y11);
		  SubCells(Y10);
		  SubCells(Y9);
		  SubCells(Y8);
		  SubCells(Y7);
		  SubCells(Y6);
		  SubCells(Y5);
		  SubCells(Y4);
		  SubCells(Y3);
		  SubCells(Y2);
		  SubCells(Y1);
		  SubCells(Y0);

		  //ShiftRows(Y15,Y14,Y13,Y12,0);
		  ShiftRows(Y11,Y10,Y9,Y8,1);
		  ShiftRows(Y7,Y6,Y5,Y4,2);
		  ShiftRows(Y3,Y2,Y1,Y0,3);

		  //MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
		  MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);


		  //second round
		  AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,1);
          SubCells(Y15);
 		  SubCells(Y14);
		  SubCells(Y13);
		  SubCells(Y12);
		  SubCells(Y11);
		  SubCells(Y10);
		  SubCells(Y9);
		  SubCells(Y8);
		  SubCells(Y7);
		  SubCells(Y6);
		  SubCells(Y5);
		  SubCells(Y4);
		  SubCells(Y3);
		  SubCells(Y2);
		  SubCells(Y1);
		  SubCells(Y0);
 		  //ShiftRows(Y15,Y14,Y13,Y12,0);
  		  ShiftRows(Y11,Y10,Y9,Y8,1);
  		  ShiftRows(Y7,Y6,Y5,Y4,2);
  		  ShiftRows(Y3,Y2,Y1,Y0,3);
  		  //MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  //Third round
  		 AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,2);
  		 SubCells(Y15);
  		 SubCells(Y14);
  		 SubCells(Y13);
  		 SubCells(Y12);
  		 SubCells(Y11);
  		 SubCells(Y10);
  		 SubCells(Y9);
  		 SubCells(Y8);
  		 SubCells(Y7);
  		 SubCells(Y6);
  		 SubCells(Y5);
  		 SubCells(Y4);
  		 SubCells(Y3);
  		 SubCells(Y2);
  		 SubCells(Y1);
  		 SubCells(Y0);
	  //ShiftRows(Y15,Y14,Y13,Y12,0);
        ShiftRows(Y11,Y10,Y9,Y8,1);
  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		ShiftRows(Y3,Y2,Y1,Y0,3);
	  //MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
	  MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

	  //Fourth Round
	  AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,3);
	  SubCells(Y15);
	  SubCells(Y14);
	  SubCells(Y13);
	  SubCells(Y12);
	  SubCells(Y11);
	  SubCells(Y10);
	  SubCells(Y9);
	  SubCells(Y8);
	  SubCells(Y7);
	  SubCells(Y6);
	  SubCells(Y5);
	  SubCells(Y4);
	  SubCells(Y3);
	  SubCells(Y2);
	  SubCells(Y1);
	  SubCells(Y0);
      //ShiftRows(Y15,Y14,Y13,Y12,0);
	  ShiftRows(Y11,Y10,Y9,Y8,1);
	  ShiftRows(Y7,Y6,Y5,Y4,2);
	  ShiftRows(Y3,Y2,Y1,Y0,3);
	  //MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
	  MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  	*Y15 = *Y15 ^ *key15;
  	*Y14 = *Y14 ^ *key14;
  	*Y13 = *Y13 ^ *key13;
  	*Y12 = *Y12 ^ *key12;
  	*Y11 = *Y11 ^ *key11;
  	*Y10 = *Y10 ^ *key10;
  	*Y9 = *Y9 ^ *key9;
  	*Y8 = *Y8 ^ *key8;
  	*Y7 = *Y7 ^ *key7;
  	*Y6 = *Y6 ^ *key6;
  	*Y5 = *Y5 ^ *key5;
  	*Y4 = *Y4 ^ *key4;
  	*Y3 = *Y3 ^ *key3;
  	*Y2 = *Y2 ^ *key2;
  	*Y1 = *Y1 ^ *key1;
  	*Y0 = *Y0 ^ *key0;

   	  //First round
  	   AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,4);
  	   SubCells(Y15);
  	   SubCells(Y14);
	   SubCells(Y13);
  	   SubCells(Y12);
  	   SubCells(Y11);
  	   SubCells(Y10);
  	   SubCells(Y9);
  	   SubCells(Y8);
  	   SubCells(Y7);
  	   SubCells(Y6);
  	   SubCells(Y5);
  	   SubCells(Y4);
  	   SubCells(Y3);
  	   SubCells(Y2);
  	   SubCells(Y1);
  	   SubCells(Y0);

  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		ShiftRows(Y3,Y2,Y1,Y0,3);

  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);


  		//second round
  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,5);
  		SubCells(Y15);
  		SubCells(Y14);
  		SubCells(Y13);
  		SubCells(Y12);
  		SubCells(Y11);
  		SubCells(Y10);
  		SubCells(Y9);
  		SubCells(Y8);
  		SubCells(Y7);
  		SubCells(Y6);
  		SubCells(Y5);
  		SubCells(Y4);
  		SubCells(Y3);
  		SubCells(Y2);
  		SubCells(Y1);
  		SubCells(Y0);
  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		//Third round
  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,6);
  		SubCells(Y15);
  		SubCells(Y14);
  		SubCells(Y13);
  		SubCells(Y12);
  		SubCells(Y11);
  		SubCells(Y10);
  		SubCells(Y9);
  		SubCells(Y8);
  		SubCells(Y7);
  		SubCells(Y6);
  		SubCells(Y5);
  		SubCells(Y4);
  		SubCells(Y3);
  		SubCells(Y2);
  		SubCells(Y1);
  		SubCells(Y0);
  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		//Fourth Round
  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,7);
  		SubCells(Y15);
  		SubCells(Y14);
  		SubCells(Y13);
  		SubCells(Y12);
  		SubCells(Y11);
  		SubCells(Y10);
  		SubCells(Y9);
  		SubCells(Y8);
  		SubCells(Y7);
  		SubCells(Y6);
  		SubCells(Y5);
  		SubCells(Y4);
  		SubCells(Y3);
  		SubCells(Y2);
  		SubCells(Y1);
  		SubCells(Y0);
  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		*Y15 = *Y15 ^ *key15;
  		*Y14 = *Y14 ^ *key14;
  		*Y13 = *Y13 ^ *key13;
  		*Y12 = *Y12 ^ *key12;
  		*Y11 = *Y11 ^ *key11;
  		*Y10 = *Y10 ^ *key10;
  		*Y9 = *Y9 ^ *key9;
  		*Y8 = *Y8 ^ *key8;
  		*Y7 = *Y7 ^ *key7;
  		*Y6 = *Y6 ^ *key6;
  		*Y5 = *Y5 ^ *key5;
  		*Y4 = *Y4 ^ *key4;
  		*Y3 = *Y3 ^ *key3;
  		*Y2 = *Y2 ^ *key2;
  		*Y1 = *Y1 ^ *key1;
  		*Y0 = *Y0 ^ *key0;


  		//First round
  		  	   AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,8);
  		  	   SubCells(Y15);
  		  	   SubCells(Y14);
  			   SubCells(Y13);
  		  	   SubCells(Y12);
  		  	   SubCells(Y11);
  		  	   SubCells(Y10);
  		  	   SubCells(Y9);
  		  	   SubCells(Y8);
  		  	   SubCells(Y7);
  		  	   SubCells(Y6);
  		  	   SubCells(Y5);
  		  	   SubCells(Y4);
  		  	   SubCells(Y3);
  		  	   SubCells(Y2);
  		  	   SubCells(Y1);
  		  	   SubCells(Y0);

  		  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  		ShiftRows(Y3,Y2,Y1,Y0,3);

  		  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);


  		  		//second round
  		  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,9);
  		  		SubCells(Y15);
  		  		SubCells(Y14);
  		  		SubCells(Y13);
  		  		SubCells(Y12);
  		  		SubCells(Y11);
  		  		SubCells(Y10);
  		  		SubCells(Y9);
  		  		SubCells(Y8);
  		  		SubCells(Y7);
  		  		SubCells(Y6);
  		  		SubCells(Y5);
  		  		SubCells(Y4);
  		  		SubCells(Y3);
  		  		SubCells(Y2);
  		  		SubCells(Y1);
  		  		SubCells(Y0);
  		  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  		//Third round
  		  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,10);
  		  		SubCells(Y15);
  		  		SubCells(Y14);
  		  		SubCells(Y13);
  		  		SubCells(Y12);
  		  		SubCells(Y11);
  		  		SubCells(Y10);
  		  		SubCells(Y9);
  		  		SubCells(Y8);
  		  		SubCells(Y7);
  		  		SubCells(Y6);
  		  		SubCells(Y5);
  		  		SubCells(Y4);
  		  		SubCells(Y3);
  		  		SubCells(Y2);
  		  		SubCells(Y1);
  		  		SubCells(Y0);
  		  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  		//Fourth Round
  		  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,11);
  		  		SubCells(Y15);
  		  		SubCells(Y14);
  		  		SubCells(Y13);
  		  		SubCells(Y12);
  		  		SubCells(Y11);
  		  		SubCells(Y10);
  		  		SubCells(Y9);
  		  		SubCells(Y8);
  		  		SubCells(Y7);
  		  		SubCells(Y6);
  		  		SubCells(Y5);
  		  		SubCells(Y4);
  		  		SubCells(Y3);
  		  		SubCells(Y2);
  		  		SubCells(Y1);
  		  		SubCells(Y0);
  		  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  		*Y15 = *Y15 ^ *key15;
  		  		*Y14 = *Y14 ^ *key14;
  		  		*Y13 = *Y13 ^ *key13;
  		  		*Y12 = *Y12 ^ *key12;
  		  		*Y11 = *Y11 ^ *key11;
  		  		*Y10 = *Y10 ^ *key10;
  		  		*Y9 = *Y9 ^ *key9;
  		  		*Y8 = *Y8 ^ *key8;
  		  		*Y7 = *Y7 ^ *key7;
  		  		*Y6 = *Y6 ^ *key6;
  		  		*Y5 = *Y5 ^ *key5;
  		  		*Y4 = *Y4 ^ *key4;
  		  		*Y3 = *Y3 ^ *key3;
  		  		*Y2 = *Y2 ^ *key2;
  		  		*Y1 = *Y1 ^ *key1;
  		  		*Y0 = *Y0 ^ *key0;

  		  	//First round
  		  	  	   AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,12);
  		  	  	   SubCells(Y15);
  		  	  	   SubCells(Y14);
  		  		   SubCells(Y13);
  		  	  	   SubCells(Y12);
  		  	  	   SubCells(Y11);
  		  	  	   SubCells(Y10);
  		  	  	   SubCells(Y9);
  		  	  	   SubCells(Y8);
  		  	  	   SubCells(Y7);
  		  	  	   SubCells(Y6);
  		  	  	   SubCells(Y5);
  		  	  	   SubCells(Y4);
  		  	  	   SubCells(Y3);
  		  	  	   SubCells(Y2);
  		  	  	   SubCells(Y1);
  		  	  	   SubCells(Y0);

  		  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  		ShiftRows(Y3,Y2,Y1,Y0,3);

  		  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);


  		  	  		//second round
  		  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,13);
  		  	  		SubCells(Y15);
  		  	  		SubCells(Y14);
  		  	  		SubCells(Y13);
  		  	  		SubCells(Y12);
  		  	  		SubCells(Y11);
  		  	  		SubCells(Y10);
  		  	  		SubCells(Y9);
  		  	  		SubCells(Y8);
  		  	  		SubCells(Y7);
  		  	  		SubCells(Y6);
  		  	  		SubCells(Y5);
  		  	  		SubCells(Y4);
  		  	  		SubCells(Y3);
  		  	  		SubCells(Y2);
  		  	  		SubCells(Y1);
  		  	  		SubCells(Y0);
  		  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  		//Third round
  		  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,14);
  		  	  		SubCells(Y15);
  		  	  		SubCells(Y14);
  		  	  		SubCells(Y13);
  		  	  		SubCells(Y12);
  		  	  		SubCells(Y11);
  		  	  		SubCells(Y10);
  		  	  		SubCells(Y9);
  		  	  		SubCells(Y8);
  		  	  		SubCells(Y7);
  		  	  		SubCells(Y6);
  		  	  		SubCells(Y5);
  		  	  		SubCells(Y4);
  		  	  		SubCells(Y3);
  		  	  		SubCells(Y2);
  		  	  		SubCells(Y1);
  		  	  		SubCells(Y0);
  		  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  		//Fourth Round
  		  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,15);
  		  	  		SubCells(Y15);
  		  	  		SubCells(Y14);
  		  	  		SubCells(Y13);
  		  	  		SubCells(Y12);
  		  	  		SubCells(Y11);
  		  	  		SubCells(Y10);
  		  	  		SubCells(Y9);
  		  	  		SubCells(Y8);
  		  	  		SubCells(Y7);
  		  	  		SubCells(Y6);
  		  	  		SubCells(Y5);
  		  	  		SubCells(Y4);
  		  	  		SubCells(Y3);
  		  	  		SubCells(Y2);
  		  	  		SubCells(Y1);
  		  	  		SubCells(Y0);
  		  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  		*Y15 = *Y15 ^ *key15;
  		  	  		*Y14 = *Y14 ^ *key14;
  		  	  		*Y13 = *Y13 ^ *key13;
  		  	  		*Y12 = *Y12 ^ *key12;
  		  	  		*Y11 = *Y11 ^ *key11;
  		  	  		*Y10 = *Y10 ^ *key10;
  		  	  		*Y9 = *Y9 ^ *key9;
  		  	  		*Y8 = *Y8 ^ *key8;
  		  	  		*Y7 = *Y7 ^ *key7;
  		  	  		*Y6 = *Y6 ^ *key6;
  		  	  		*Y5 = *Y5 ^ *key5;
  		  	  		*Y4 = *Y4 ^ *key4;
  		  	  		*Y3 = *Y3 ^ *key3;
  		  	  		*Y2 = *Y2 ^ *key2;
  		  	  		*Y1 = *Y1 ^ *key1;
  		  	  		*Y0 = *Y0 ^ *key0;

  		  	  	 //First round
  		  	  			  AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,16);
  		  	  	     	  SubCells(Y15);
  		  	  			  SubCells(Y14);
  		  	  			  SubCells(Y13);
  		  	  			  SubCells(Y12);
  		  	  			  SubCells(Y11);
  		  	  			  SubCells(Y10);
  		  	  			  SubCells(Y9);
  		  	  			  SubCells(Y8);
  		  	  			  SubCells(Y7);
  		  	  			  SubCells(Y6);
  		  	  			  SubCells(Y5);
  		  	  			  SubCells(Y4);
  		  	  			  SubCells(Y3);
  		  	  			  SubCells(Y2);
  		  	  			  SubCells(Y1);
  		  	  			  SubCells(Y0);

  		  	  			  //ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  			  ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  			  ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  			  ShiftRows(Y3,Y2,Y1,Y0,3);

  		  	  			  //MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  			  MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);


  		  	  			  //second round
  		  	  			  AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,17);
  		  	  	          SubCells(Y15);
  		  	  	 		  SubCells(Y14);
  		  	  			  SubCells(Y13);
  		  	  			  SubCells(Y12);
  		  	  			  SubCells(Y11);
  		  	  			  SubCells(Y10);
  		  	  			  SubCells(Y9);
  		  	  			  SubCells(Y8);
  		  	  			  SubCells(Y7);
  		  	  			  SubCells(Y6);
  		  	  			  SubCells(Y5);
  		  	  			  SubCells(Y4);
  		  	  			  SubCells(Y3);
  		  	  			  SubCells(Y2);
  		  	  			  SubCells(Y1);
  		  	  			  SubCells(Y0);
  		  	  	 		  //ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		  //MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		  //Third round
  		  	  	  		 AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,18);
  		  	  	  		 SubCells(Y15);
  		  	  	  		 SubCells(Y14);
  		  	  	  		 SubCells(Y13);
  		  	  	  		 SubCells(Y12);
  		  	  	  		 SubCells(Y11);
  		  	  	  		 SubCells(Y10);
  		  	  	  		 SubCells(Y9);
  		  	  	  		 SubCells(Y8);
  		  	  	  		 SubCells(Y7);
  		  	  	  		 SubCells(Y6);
  		  	  	  		 SubCells(Y5);
  		  	  	  		 SubCells(Y4);
  		  	  	  		 SubCells(Y3);
  		  	  	  		 SubCells(Y2);
  		  	  	  		 SubCells(Y1);
  		  	  	  		 SubCells(Y0);
  		  	  		  //ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	        ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  		  //MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  		  MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  		  //Fourth Round
  		  	  		  AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,19);
  		  	  		  SubCells(Y15);
  		  	  		  SubCells(Y14);
  		  	  		  SubCells(Y13);
  		  	  		  SubCells(Y12);
  		  	  		  SubCells(Y11);
  		  	  		  SubCells(Y10);
  		  	  		  SubCells(Y9);
  		  	  		  SubCells(Y8);
  		  	  		  SubCells(Y7);
  		  	  		  SubCells(Y6);
  		  	  		  SubCells(Y5);
  		  	  		  SubCells(Y4);
  		  	  		  SubCells(Y3);
  		  	  		  SubCells(Y2);
  		  	  		  SubCells(Y1);
  		  	  		  SubCells(Y0);
  		  	  	      //ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  		  ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  		  ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  		  ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  		  //MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  		  MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  	*Y15 = *Y15 ^ *key15;
  		  	  	  	*Y14 = *Y14 ^ *key14;
  		  	  	  	*Y13 = *Y13 ^ *key13;
  		  	  	  	*Y12 = *Y12 ^ *key12;
  		  	  	  	*Y11 = *Y11 ^ *key11;
  		  	  	  	*Y10 = *Y10 ^ *key10;
  		  	  	  	*Y9 = *Y9 ^ *key9;
  		  	  	  	*Y8 = *Y8 ^ *key8;
  		  	  	  	*Y7 = *Y7 ^ *key7;
  		  	  	  	*Y6 = *Y6 ^ *key6;
  		  	  	  	*Y5 = *Y5 ^ *key5;
  		  	  	  	*Y4 = *Y4 ^ *key4;
  		  	  	  	*Y3 = *Y3 ^ *key3;
  		  	  	  	*Y2 = *Y2 ^ *key2;
  		  	  	  	*Y1 = *Y1 ^ *key1;
  		  	  	  	*Y0 = *Y0 ^ *key0;

  		  	  	   	  //First round
  		  	  	  	   AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,20);
  		  	  	  	   SubCells(Y15);
  		  	  	  	   SubCells(Y14);
  		  	  		   SubCells(Y13);
  		  	  	  	   SubCells(Y12);
  		  	  	  	   SubCells(Y11);
  		  	  	  	   SubCells(Y10);
  		  	  	  	   SubCells(Y9);
  		  	  	  	   SubCells(Y8);
  		  	  	  	   SubCells(Y7);
  		  	  	  	   SubCells(Y6);
  		  	  	  	   SubCells(Y5);
  		  	  	  	   SubCells(Y4);
  		  	  	  	   SubCells(Y3);
  		  	  	  	   SubCells(Y2);
  		  	  	  	   SubCells(Y1);
  		  	  	  	   SubCells(Y0);

  		  	  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		ShiftRows(Y3,Y2,Y1,Y0,3);

  		  	  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);


  		  	  	  		//second round
  		  	  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,21);
  		  	  	  		SubCells(Y15);
  		  	  	  		SubCells(Y14);
  		  	  	  		SubCells(Y13);
  		  	  	  		SubCells(Y12);
  		  	  	  		SubCells(Y11);
  		  	  	  		SubCells(Y10);
  		  	  	  		SubCells(Y9);
  		  	  	  		SubCells(Y8);
  		  	  	  		SubCells(Y7);
  		  	  	  		SubCells(Y6);
  		  	  	  		SubCells(Y5);
  		  	  	  		SubCells(Y4);
  		  	  	  		SubCells(Y3);
  		  	  	  		SubCells(Y2);
  		  	  	  		SubCells(Y1);
  		  	  	  		SubCells(Y0);
  		  	  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		//Third round
  		  	  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,22);
  		  	  	  		SubCells(Y15);
  		  	  	  		SubCells(Y14);
  		  	  	  		SubCells(Y13);
  		  	  	  		SubCells(Y12);
  		  	  	  		SubCells(Y11);
  		  	  	  		SubCells(Y10);
  		  	  	  		SubCells(Y9);
  		  	  	  		SubCells(Y8);
  		  	  	  		SubCells(Y7);
  		  	  	  		SubCells(Y6);
  		  	  	  		SubCells(Y5);
  		  	  	  		SubCells(Y4);
  		  	  	  		SubCells(Y3);
  		  	  	  		SubCells(Y2);
  		  	  	  		SubCells(Y1);
  		  	  	  		SubCells(Y0);
  		  	  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		//Fourth Round
  		  	  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,23);
  		  	  	  		SubCells(Y15);
  		  	  	  		SubCells(Y14);
  		  	  	  		SubCells(Y13);
  		  	  	  		SubCells(Y12);
  		  	  	  		SubCells(Y11);
  		  	  	  		SubCells(Y10);
  		  	  	  		SubCells(Y9);
  		  	  	  		SubCells(Y8);
  		  	  	  		SubCells(Y7);
  		  	  	  		SubCells(Y6);
  		  	  	  		SubCells(Y5);
  		  	  	  		SubCells(Y4);
  		  	  	  		SubCells(Y3);
  		  	  	  		SubCells(Y2);
  		  	  	  		SubCells(Y1);
  		  	  	  		SubCells(Y0);
  		  	  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		*Y15 = *Y15 ^ *key15;
  		  	  	  		*Y14 = *Y14 ^ *key14;
  		  	  	  		*Y13 = *Y13 ^ *key13;
  		  	  	  		*Y12 = *Y12 ^ *key12;
  		  	  	  		*Y11 = *Y11 ^ *key11;
  		  	  	  		*Y10 = *Y10 ^ *key10;
  		  	  	  		*Y9 = *Y9 ^ *key9;
  		  	  	  		*Y8 = *Y8 ^ *key8;
  		  	  	  		*Y7 = *Y7 ^ *key7;
  		  	  	  		*Y6 = *Y6 ^ *key6;
  		  	  	  		*Y5 = *Y5 ^ *key5;
  		  	  	  		*Y4 = *Y4 ^ *key4;
  		  	  	  		*Y3 = *Y3 ^ *key3;
  		  	  	  		*Y2 = *Y2 ^ *key2;
  		  	  	  		*Y1 = *Y1 ^ *key1;
  		  	  	  		*Y0 = *Y0 ^ *key0;


  		  	  	  		//First round
  		  	  	  		  	   AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,24);
  		  	  	  		  	   SubCells(Y15);
  		  	  	  		  	   SubCells(Y14);
  		  	  	  			   SubCells(Y13);
  		  	  	  		  	   SubCells(Y12);
  		  	  	  		  	   SubCells(Y11);
  		  	  	  		  	   SubCells(Y10);
  		  	  	  		  	   SubCells(Y9);
  		  	  	  		  	   SubCells(Y8);
  		  	  	  		  	   SubCells(Y7);
  		  	  	  		  	   SubCells(Y6);
  		  	  	  		  	   SubCells(Y5);
  		  	  	  		  	   SubCells(Y4);
  		  	  	  		  	   SubCells(Y3);
  		  	  	  		  	   SubCells(Y2);
  		  	  	  		  	   SubCells(Y1);
  		  	  	  		  	   SubCells(Y0);

  		  	  	  		  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  		ShiftRows(Y3,Y2,Y1,Y0,3);

  		  	  	  		  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);


  		  	  	  		  		//second round
  		  	  	  		  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,25);
  		  	  	  		  		SubCells(Y15);
  		  	  	  		  		SubCells(Y14);
  		  	  	  		  		SubCells(Y13);
  		  	  	  		  		SubCells(Y12);
  		  	  	  		  		SubCells(Y11);
  		  	  	  		  		SubCells(Y10);
  		  	  	  		  		SubCells(Y9);
  		  	  	  		  		SubCells(Y8);
  		  	  	  		  		SubCells(Y7);
  		  	  	  		  		SubCells(Y6);
  		  	  	  		  		SubCells(Y5);
  		  	  	  		  		SubCells(Y4);
  		  	  	  		  		SubCells(Y3);
  		  	  	  		  		SubCells(Y2);
  		  	  	  		  		SubCells(Y1);
  		  	  	  		  		SubCells(Y0);
  		  	  	  		  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		  		//Third round
  		  	  	  		  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,26);
  		  	  	  		  		SubCells(Y15);
  		  	  	  		  		SubCells(Y14);
  		  	  	  		  		SubCells(Y13);
  		  	  	  		  		SubCells(Y12);
  		  	  	  		  		SubCells(Y11);
  		  	  	  		  		SubCells(Y10);
  		  	  	  		  		SubCells(Y9);
  		  	  	  		  		SubCells(Y8);
  		  	  	  		  		SubCells(Y7);
  		  	  	  		  		SubCells(Y6);
  		  	  	  		  		SubCells(Y5);
  		  	  	  		  		SubCells(Y4);
  		  	  	  		  		SubCells(Y3);
  		  	  	  		  		SubCells(Y2);
  		  	  	  		  		SubCells(Y1);
  		  	  	  		  		SubCells(Y0);
  		  	  	  		  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		  		//Fourth Round
  		  	  	  		  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,27);
  		  	  	  		  		SubCells(Y15);
  		  	  	  		  		SubCells(Y14);
  		  	  	  		  		SubCells(Y13);
  		  	  	  		  		SubCells(Y12);
  		  	  	  		  		SubCells(Y11);
  		  	  	  		  		SubCells(Y10);
  		  	  	  		  		SubCells(Y9);
  		  	  	  		  		SubCells(Y8);
  		  	  	  		  		SubCells(Y7);
  		  	  	  		  		SubCells(Y6);
  		  	  	  		  		SubCells(Y5);
  		  	  	  		  		SubCells(Y4);
  		  	  	  		  		SubCells(Y3);
  		  	  	  		  		SubCells(Y2);
  		  	  	  		  		SubCells(Y1);
  		  	  	  		  		SubCells(Y0);
  		  	  	  		  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		  		*Y15 = *Y15 ^ *key15;
  		  	  	  		  		*Y14 = *Y14 ^ *key14;
  		  	  	  		  		*Y13 = *Y13 ^ *key13;
  		  	  	  		  		*Y12 = *Y12 ^ *key12;
  		  	  	  		  		*Y11 = *Y11 ^ *key11;
  		  	  	  		  		*Y10 = *Y10 ^ *key10;
  		  	  	  		  		*Y9 = *Y9 ^ *key9;
  		  	  	  		  		*Y8 = *Y8 ^ *key8;
  		  	  	  		  		*Y7 = *Y7 ^ *key7;
  		  	  	  		  		*Y6 = *Y6 ^ *key6;
  		  	  	  		  		*Y5 = *Y5 ^ *key5;
  		  	  	  		  		*Y4 = *Y4 ^ *key4;
  		  	  	  		  		*Y3 = *Y3 ^ *key3;
  		  	  	  		  		*Y2 = *Y2 ^ *key2;
  		  	  	  		  		*Y1 = *Y1 ^ *key1;
  		  	  	  		  		*Y0 = *Y0 ^ *key0;

  		  	  	  		  	//First round
  		  	  	  		  	  	   AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,28);
  		  	  	  		  	  	   SubCells(Y15);
  		  	  	  		  	  	   SubCells(Y14);
  		  	  	  		  		   SubCells(Y13);
  		  	  	  		  	  	   SubCells(Y12);
  		  	  	  		  	  	   SubCells(Y11);
  		  	  	  		  	  	   SubCells(Y10);
  		  	  	  		  	  	   SubCells(Y9);
  		  	  	  		  	  	   SubCells(Y8);
  		  	  	  		  	  	   SubCells(Y7);
  		  	  	  		  	  	   SubCells(Y6);
  		  	  	  		  	  	   SubCells(Y5);
  		  	  	  		  	  	   SubCells(Y4);
  		  	  	  		  	  	   SubCells(Y3);
  		  	  	  		  	  	   SubCells(Y2);
  		  	  	  		  	  	   SubCells(Y1);
  		  	  	  		  	  	   SubCells(Y0);

  		  	  	  		  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  	  		ShiftRows(Y3,Y2,Y1,Y0,3);

  		  	  	  		  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);


  		  	  	  		  	  		//second round
  		  	  	  		  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,29);
  		  	  	  		  	  		SubCells(Y15);
  		  	  	  		  	  		SubCells(Y14);
  		  	  	  		  	  		SubCells(Y13);
  		  	  	  		  	  		SubCells(Y12);
  		  	  	  		  	  		SubCells(Y11);
  		  	  	  		  	  		SubCells(Y10);
  		  	  	  		  	  		SubCells(Y9);
  		  	  	  		  	  		SubCells(Y8);
  		  	  	  		  	  		SubCells(Y7);
  		  	  	  		  	  		SubCells(Y6);
  		  	  	  		  	  		SubCells(Y5);
  		  	  	  		  	  		SubCells(Y4);
  		  	  	  		  	  		SubCells(Y3);
  		  	  	  		  	  		SubCells(Y2);
  		  	  	  		  	  		SubCells(Y1);
  		  	  	  		  	  		SubCells(Y0);
  		  	  	  		  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		  	  		//Third round
  		  	  	  		  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,30);
  		  	  	  		  	  		SubCells(Y15);
  		  	  	  		  	  		SubCells(Y14);
  		  	  	  		  	  		SubCells(Y13);
  		  	  	  		  	  		SubCells(Y12);
  		  	  	  		  	  		SubCells(Y11);
  		  	  	  		  	  		SubCells(Y10);
  		  	  	  		  	  		SubCells(Y9);
  		  	  	  		  	  		SubCells(Y8);
  		  	  	  		  	  		SubCells(Y7);
  		  	  	  		  	  		SubCells(Y6);
  		  	  	  		  	  		SubCells(Y5);
  		  	  	  		  	  		SubCells(Y4);
  		  	  	  		  	  		SubCells(Y3);
  		  	  	  		  	  		SubCells(Y2);
  		  	  	  		  	  		SubCells(Y1);
  		  	  	  		  	  		SubCells(Y0);
  		  	  	  		  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		  	  		//Fourth Round
  		  	  	  		  	  		AddConstants(Y15,Y14,Y11,Y10,Y7,Y6,Y3,Y2,31);
  		  	  	  		  	  		SubCells(Y15);
  		  	  	  		  	  		SubCells(Y14);
  		  	  	  		  	  		SubCells(Y13);
  		  	  	  		  	  		SubCells(Y12);
  		  	  	  		  	  		SubCells(Y11);
  		  	  	  		  	  		SubCells(Y10);
  		  	  	  		  	  		SubCells(Y9);
  		  	  	  		  	  		SubCells(Y8);
  		  	  	  		  	  		SubCells(Y7);
  		  	  	  		  	  		SubCells(Y6);
  		  	  	  		  	  		SubCells(Y5);
  		  	  	  		  	  		SubCells(Y4);
  		  	  	  		  	  		SubCells(Y3);
  		  	  	  		  	  		SubCells(Y2);
  		  	  	  		  	  		SubCells(Y1);
  		  	  	  		  	  		SubCells(Y0);
  		  	  	  		  	  		//ShiftRows(Y15,Y14,Y13,Y12,0);
  		  	  	  		  	  		ShiftRows(Y11,Y10,Y9,Y8,1);
  		  	  	  		  	  		ShiftRows(Y7,Y6,Y5,Y4,2);
  		  	  	  		  	  		ShiftRows(Y3,Y2,Y1,Y0,3);
  		  	  	  		  	  		//MixColumn(Y15,Y14,Y13,Y12,Y10,Y9,Y8,Y11,Y5,Y4,Y7,Y6,Y0,Y3,Y2,Y1);
  		  	  	  		  	  		MixColumn(Y15,Y14,Y13,Y12,Y11,Y10,Y9,Y8,Y7,Y6,Y5,Y4,Y3,Y2,Y1,Y0);

  		  	  	  		  	  		*Y15 = *Y15 ^ *key15;
  		  	  	  		  	  		*Y14 = *Y14 ^ *key14;
  		  	  	  		  	  		*Y13 = *Y13 ^ *key13;
  		  	  	  		  	  		*Y12 = *Y12 ^ *key12;
  		  	  	  		  	  		*Y11 = *Y11 ^ *key11;
  		  	  	  		  	  		*Y10 = *Y10 ^ *key10;
  		  	  	  		  	  		*Y9 = *Y9 ^ *key9;
  		  	  	  		  	  		*Y8 = *Y8 ^ *key8;
  		  	  	  		  	  		*Y7 = *Y7 ^ *key7;
  		  	  	  		  	  		*Y6 = *Y6 ^ *key6;
  		  	  	  		  	  		*Y5 = *Y5 ^ *key5;
  		  	  	  		  	  		*Y4 = *Y4 ^ *key4;
  		  	  	  		  	  		*Y3 = *Y3 ^ *key3;
  		  	  	  		  	  		*Y2 = *Y2 ^ *key2;
  		  	  	  		  	  		*Y1 = *Y1 ^ *key1;
  		  	  	  		  	  		*Y0 = *Y0 ^ *key0;


  //}
}

int main(int arc, char **argv) {
  uint64_t plaintexts[16];
  uint64_t ciphertexts[16];
  uint64_t key[16];
  uint64_t ptmp[16];
  uint64_t ktmp[16];

    plaintexts[0] =  0x0000000000000000; key[0] =  0x0000000000000000;
    plaintexts[1] =  0x0123456789ABCDEF; key[1] = 0x0123456789ABCDEF;
    plaintexts[2] = 0x0000000000000000; key[2] =  0x0000000000000000;
    plaintexts[3] = 0x0123456789ABCDEF; key[3] = 0x0123456789ABCDEF;
    plaintexts[4] =  0x0000000000000000; key[4] =  0x0000000000000000;
    plaintexts[5] =  0x0123456789ABCDEF; key[5] = 0x0123456789ABCDEF;
    plaintexts[6] = 0x0000000000000000; key[6] =  0x0000000000000000;
    plaintexts[7] = 0x0123456789ABCDEF; key[7] = 0x0123456789ABCDEF;
    plaintexts[8] =  0x0000000000000000; key[8] =  0x0000000000000000;
    plaintexts[9] =  0x0123456789ABCDEF; key[9] = 0x0123456789ABCDEF;
    plaintexts[10] = 0x0000000000000000; key[10] =  0x0000000000000000;
    plaintexts[11] = 0x0123456789ABCDEF; key[11] = 0x0123456789ABCDEF;
    plaintexts[12] =  0x0000000000000000; key[12] =  0x0000000000000000;
    plaintexts[13] =  0x0123456789ABCDEF; key[13] = 0x0123456789ABCDEF;
    plaintexts[14] = 0x0000000000000000; key[14] =  0x0000000000000000;
    plaintexts[15] = 0x0123456789ABCDEF; key[15] = 0x0123456789ABCDEF;


    transpose(&ktmp[15], &ktmp[14], &ktmp[13], &ktmp[12], &ktmp[11], &ktmp[10],&ktmp[9],&ktmp[8],&ktmp[7],&ktmp[6],&ktmp[5],&ktmp[4],&ktmp[3],&ktmp[2],&ktmp[1],&ktmp[0], key[0],key[1],key[2],key[3],key[4],key[5],key[6],key[7],key[8],key[9],key[10],key[11],key[12],key[13],key[14],key[15]);

    transpose(&ptmp[15], &ptmp[14], &ptmp[13], &ptmp[12], &ptmp[11], &ptmp[10],&ptmp[9],&ptmp[8],&ptmp[7],&ptmp[6],&ptmp[5],&ptmp[4],&ptmp[3],&ptmp[2],&ptmp[1],&ptmp[0], plaintexts[0],plaintexts[1],plaintexts[2],plaintexts[3],plaintexts[4],plaintexts[5],plaintexts[6],plaintexts[7],plaintexts[8],plaintexts[9],plaintexts[10],plaintexts[11],plaintexts[12],plaintexts[13],plaintexts[14],plaintexts[15]);


    encrypt(&ptmp[15], &ptmp[14], &ptmp[13], &ptmp[12], &ptmp[11], &ptmp[10],&ptmp[9],&ptmp[8],&ptmp[7],&ptmp[6],&ptmp[5],&ptmp[4],&ptmp[3],&ptmp[2],&ptmp[1],&ptmp[0],&ktmp[15], &ktmp[14], &ktmp[13], &ktmp[12], &ktmp[11], &ktmp[10],&ktmp[9],&ktmp[8],&ktmp[7],&ktmp[6],&ktmp[5],&ktmp[4],&ktmp[3],&ktmp[2],&ktmp[1],&ktmp[0]);

    transpose(&ciphertexts[0],&ciphertexts[1],&ciphertexts[2],&ciphertexts[3],&ciphertexts[4],&ciphertexts[5],&ciphertexts[6],&ciphertexts[7],&ciphertexts[8],&ciphertexts[9],&ciphertexts[10],&ciphertexts[11],&ciphertexts[12],&ciphertexts[13],&ciphertexts[14],&ciphertexts[15], ptmp[15], ptmp[14], ptmp[13], ptmp[12], ptmp[11], ptmp[10], ptmp[9],  ptmp[8], ptmp[7], ptmp[6], ptmp[5], ptmp[4], ptmp[3], ptmp[2], ptmp[1], ptmp[0]);

    printf("\n    plaintext            key          ciphertext\n");
    for(int i=0;i<16;i++)
    {
    	printf("\n %016llx   %016llx   %016llx",plaintexts[i],key[i],ciphertexts[i]);
	}
    printf("\n");

  return 0;
}

